(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95187,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var l={callServer:function(){return s.callServer},createServerReference:function(){return n.createServerReference},findSourceMapURL:function(){return i.findSourceMapURL}};for(var a in l)Object.defineProperty(r,a,{enumerable:!0,get:l[a]});let s=e.r(132120),i=e.r(92245),n=e.r(235326)},178583,e=>{"use strict";let t=(0,e.i(475254).default)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["FileText",()=>t],178583)},675335,e=>{"use strict";var t=e.i(843476),r=e.i(271645);function l({imageUrl:e,boundingBox:l,pageNumber:a,onClose:s,layoutItems:i,chunkContent:n,title:d}){let c,[o,x]=(0,r.useState)(!1);(0,r.useEffect)(()=>{x(!1)},[e]);let h=e=>{if(!e||4!==e.length)return null;let[t,r,l,a]=e;return t>1||r>1||l>1||a>1?[Math.max(0,Math.min(1,t/595)),Math.max(0,Math.min(1,r/842)),Math.max(0,Math.min(1,l/595)),Math.max(0,Math.min(1,a/842))]:[t,r,l,a]},u=(()=>{if(i&&i.length>0&&n){let e=n.toLowerCase().trim(),t=null;for(let r of i){let l=r.text.toLowerCase().trim();if(!l)continue;let a=0;(e.includes(l)||l.includes(e))&&(a+=100);let s=e.split(/\s+/).filter(e=>e.length>2),i=l.split(/\s+/).filter(e=>e.length>2);a+=10*s.filter(e=>i.includes(e)).length+2*((e,t)=>{let r=0;for(let l=0;l<e.length;l++)for(let a=0;a<t.length;a++){let s=0;for(;l+s<e.length&&a+s<t.length&&e[l+s]===t[a+s];)s++;r=Math.max(r,s)}return r})(e,l),(!t||a>t.score)&&(t={item:r,score:a})}if(t&&t.score>20)return h(t.item.bbox)}return h(l)})();return(0,t.jsxs)("div",{className:"flex flex-col h-full bg-gray-50 border-l border-gray-200 shadow-xl w-full max-w-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-white border-b border-gray-200",children:[(0,t.jsxs)("div",{className:"flex flex-col min-w-0 flex-1",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900 truncate",children:d||"Evidence"}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:["Page ",a]})]}),(0,t.jsx)("button",{onClick:s,className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close evidence viewer",children:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,t.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,t.jsx)("div",{className:"flex-1 overflow-auto p-4 relative flex justify-center",children:(0,t.jsxs)("div",{className:"relative shadow-lg border border-gray-200 bg-white inline-block",children:[!o&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100 z-10",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),(0,t.jsx)("img",{src:e,alt:`Page ${a}`,className:"max-w-full h-auto block",style:{maxHeight:"calc(100vh - 150px)"},onLoad:()=>x(!0)}),o&&u&&(c=u[3]>.5,(0,t.jsx)("div",{className:"absolute border-2 border-yellow-500 mix-blend-multiply transition-all duration-300",style:{left:`${100*u[0]}%`,top:`${100*u[1]}%`,width:`${100*u[2]}%`,height:`${100*u[3]}%`,backgroundColor:`rgba(254, 240, 138, ${c?.15:.3})`,borderColor:`rgba(234, 179, 8, ${c?.5:1})`},children:(0,t.jsx)("div",{className:"absolute -top-6 left-0 bg-yellow-500 text-white text-xs px-1.5 py-0.5 rounded shadow-sm whitespace-nowrap",children:"Citation"})}))]})})]})}e.s(["EvidenceViewer",()=>l])},211328,e=>{"use strict";var t=e.i(843476),r=e.i(271645),l=e.i(178583),a=e.i(269638);function s({file:e,selected:r,onToggle:s,disabled:i}){return(0,t.jsx)("div",{onClick:()=>!i&&s(),className:`
        relative p-4 border rounded-xl cursor-pointer transition-all duration-200
        ${r?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-gray-200 bg-white hover:border-blue-300 hover:shadow-sm"}
        ${i&&!r?"opacity-50 cursor-not-allowed hover:border-gray-200 hover:shadow-none":""}
      `,children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:`p-2 rounded-lg ${r?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-500"}`,children:(0,t.jsx)(l.FileText,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900 line-clamp-1",title:e.title,children:e.title}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:[e.category," â€¢ ",e.entry_date||"No date"]})]})]}),(0,t.jsx)("div",{className:`
          w-6 h-6 rounded-full border flex items-center justify-center transition-colors
          ${r?"bg-blue-500 border-blue-500 text-white":"border-gray-300 text-transparent"}
        `,children:(0,t.jsx)(a.CheckCircle,{className:"w-4 h-4"})})]})})}var i=e.i(675335),n=e.i(975157),d=e.i(95187),c=(0,d.createServerReference)("6051f027ab6bfcc16901beb78de439860ea89cf588",d.callServer,void 0,d.findSourceMapURL,"getPageLayout");function o({docA:e,docB:l,diffData:a,onBack:s}){let[d,o]=(0,r.useState)(null),[x,h]=(0,r.useState)([]),[u,g]=(0,r.useState)([]);return r.default.useEffect(()=>{d&&(async()=>{if(d.page_A){let t=await c(e.id,d.page_A);t.success&&h(t.data||[])}if(d.page_B){let e=await c(l.id,d.page_B);e.success&&g(e.data||[])}})()},[d,e.id,l.id]),(0,t.jsxs)("div",{className:"flex h-[calc(100vh-4rem)] flex-col bg-white",children:[(0,t.jsxs)("div",{className:"border-b px-6 py-4 flex items-center justify-between bg-white",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Comparison Results"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:a.summary})]}),(0,t.jsx)("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Back to Selection"})]}),(0,t.jsx)("div",{className:"h-1/3 overflow-y-auto border-b bg-gray-50",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,t.jsx)("thead",{className:"text-xs text-gray-500 uppercase bg-gray-100 sticky top-0",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3",children:"Severity"}),(0,t.jsx)("th",{className:"px-6 py-3",children:"Clause"}),(0,t.jsx)("th",{className:"px-6 py-3",children:"Analysis"}),(0,t.jsx)("th",{className:"px-6 py-3",children:"Pages"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:a.differences.map((e,r)=>(0,t.jsxs)("tr",{onClick:()=>o(e),className:(0,n.cn)("cursor-pointer hover:bg-blue-50 transition-colors",d===e?"bg-blue-50 ring-1 ring-inset ring-blue-500":""),children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("span",{className:(0,n.cn)("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium","Critical"===e.category?"bg-red-100 text-red-800":"Major"===e.category?"bg-orange-100 text-orange-800":"Minor"===e.category?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.category})}),(0,t.jsx)("td",{className:"px-6 py-4 font-medium text-gray-900",children:e.clause}),(0,t.jsx)("td",{className:"px-6 py-4 text-gray-500",children:e.implication}),(0,t.jsx)("td",{className:"px-6 py-4 text-gray-500",children:e.page_A&&e.page_B?`P${e.page_A} vs P${e.page_B}`:"-"})]},r))})]})})}),(0,t.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,t.jsxs)("div",{className:"w-1/2 border-r border-gray-200 flex flex-col relative bg-gray-100/50",children:[(0,t.jsxs)("div",{className:"absolute top-4 left-4 z-10 bg-gray-900/80 backdrop-blur-sm text-white px-3 py-1 rounded-full text-xs font-medium shadow-sm",children:["Original: ",e.title]}),(0,t.jsx)("div",{className:"flex-1 p-4 overflow-hidden",children:(0,t.jsx)(i.EvidenceViewer,{imageUrl:`/api/files/${e.id}/pages/${d?.page_A||1}`,chunkContent:d?.docA_content,pageNumber:d?.page_A||1,title:e.title,layoutItems:x})})]}),(0,t.jsxs)("div",{className:"w-1/2 flex flex-col relative bg-gray-100/50",children:[(0,t.jsxs)("div",{className:"absolute top-4 left-4 z-10 bg-blue-600/90 backdrop-blur-sm text-white px-3 py-1 rounded-full text-xs font-medium shadow-sm",children:["Modified: ",l.title]}),(0,t.jsx)("div",{className:"flex-1 p-4 overflow-hidden",children:(0,t.jsx)(i.EvidenceViewer,{imageUrl:`/api/files/${l.id}/pages/${d?.page_B||1}`,chunkContent:d?.docB_content,pageNumber:d?.page_B||1,title:l.title,layoutItems:u})})]})]})]})}var x=(0,d.createServerReference)("606d920075f7e199818691f5938b6cf844e34393ac",d.callServer,void 0,d.findSourceMapURL,"compareFilesAction"),h=e.i(531278),u=e.i(846696);function g({files:e}){let[l,a]=(0,r.useState)([]),[i,n]=(0,r.useState)(!1),[d,c]=(0,r.useState)(null),g=async()=>{if(2===l.length){n(!0);try{let e=await x(l[0],l[1]);e.success?c(e.data):u.toast.error("Comparison failed: "+e.error)}catch(e){u.toast.error("An unexpected error occurred"),console.error(e)}finally{n(!1)}}};return d?(0,t.jsx)(o,{docA:d.docA,docB:d.docB,diffData:d,onBack:()=>c(null)}):(0,t.jsxs)("div",{className:"p-8 max-w-7xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Compare Documents"}),(0,t.jsx)("p",{className:"text-gray-500 mt-2",children:"Select two documents to analyze differences, risks, and changes."})]}),(0,t.jsx)("button",{disabled:2!==l.length||i,onClick:g,className:`
            flex items-center px-6 py-3 rounded-lg font-medium transition-all
            ${2===l.length?"bg-blue-600 text-white hover:bg-blue-700 shadow-md hover:shadow-lg":"bg-gray-100 text-gray-400 cursor-not-allowed"}
          `,children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Loader2,{className:"w-5 h-5 mr-2 animate-spin"}),"Analyzing..."]}):(0,t.jsxs)(t.Fragment,{children:["Compare ",l.length,"/2 Files"]})})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,t.jsx)(s,{file:e,selected:l.includes(e.id),onToggle:()=>(e=>{if(l.includes(e))a(t=>t.filter(t=>t!==e));else{if(l.length>=2)return void u.toast.error("You can only compare 2 files at a time");a(t=>[...t,e])}})(e.id),disabled:l.length>=2&&!l.includes(e.id)},e.id))}),0===e.length&&(0,t.jsx)("div",{className:"text-center py-12 bg-gray-50 rounded-xl border border-dashed border-gray-300",children:(0,t.jsx)("p",{className:"text-gray-500",children:"No documents found. Upload some files to get started."})})]})}e.s(["default",()=>g],211328)}]);