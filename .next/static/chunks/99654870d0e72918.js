(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95187,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i={callServer:function(){return a.callServer},createServerReference:function(){return n.createServerReference},findSourceMapURL:function(){return l.findSourceMapURL}};for(var r in i)Object.defineProperty(s,r,{enumerable:!0,get:i[r]});let a=e.r(132120),l=e.r(92245),n=e.r(235326)},191002,e=>{"use strict";var t=e.i(843476),s=e.i(271645),i=e.i(618566),r=e.i(846696),a=e.i(95187),l=(0,a.createServerReference)("40df35e55a35727faf7f01e3106f9d789490e083e1",a.callServer,void 0,a.findSourceMapURL,"deleteQuestion"),n=(0,a.createServerReference)("408bd96419fadc7e6ec02b953502587ffe9ad6d02d",a.callServer,void 0,a.findSourceMapURL,"deleteMultipleQuestions"),o=(0,a.createServerReference)("6043362c97080fff0ef43fb418428f6cf50f3063fb",a.callServer,void 0,a.findSourceMapURL,"createQuestion"),d=(0,a.createServerReference)("60f8107efab589a8495108848c0a7205001ec44599",a.callServer,void 0,a.findSourceMapURL,"updateQuestion");function c({isOpen:e,onClose:i,chapterId:a,question:l,onSuccess:n}){let[c,u]=(0,s.useTransition)(),x=!!l,[p,m]=(0,s.useState)({question_text:l?.question_text||"",question_type:l?.question_type||"MCQ",difficulty:l?.difficulty||"medium",options:l?.options||["","","",""],correct_answer:l?.correct_answer||"",explanation:l?.explanation||"",points:l?.points||1});(0,s.useEffect)(()=>{e&&m({question_text:l?.question_text||"",question_type:l?.question_type||"MCQ",difficulty:l?.difficulty||"medium",options:l?.options||["","","",""],correct_answer:l?.correct_answer||"",explanation:l?.explanation||"",points:l?.points||1})},[l,e]);let h=async e=>{if(e.preventDefault(),!p.question_text.trim()||p.question_text.length<10)return void r.toast.error("Question text must be at least 10 characters");let t=null,s=p.correct_answer;if("MCQ"===p.question_type||"TRUE_FALSE"===p.question_type)if("TRUE_FALSE"===p.question_type)t=["True","False"],s=p.correct_answer;else{let e=p.options.filter(e=>e.trim());if(e.length<2)return void r.toast.error("MCQ must have at least 2 options");t=e,s=p.correct_answer}s&&("string"!=typeof s||s.trim())?u(async()=>{try{let e,i={question_text:p.question_text,question_type:p.question_type,difficulty:p.difficulty,options:t,correct_answer:s,explanation:p.explanation||void 0,points:p.points};e=x?await d(l.id,i):await o(a,i),r.toast.success(x?"Question updated":"Question created"),n(e)}catch(e){r.toast.error(e.message||"Failed to save question")}}):r.toast.error("Correct answer is required")};if(!e)return null;let g="MCQ"===p.question_type||"TRUE_FALSE"===p.question_type;return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)("div",{className:"sticky top-0 bg-white border-b px-6 py-4",children:(0,t.jsx)("h2",{className:"text-2xl font-bold",children:x?"Edit Question":"Add New Question"})}),(0,t.jsxs)("form",{onSubmit:h,className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text *"}),(0,t.jsx)("textarea",{value:p.question_text,onChange:e=>m({...p,question_text:e.target.value}),rows:3,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Type *"}),(0,t.jsxs)("select",{value:p.question_type,onChange:e=>m({...p,question_type:e.target.value,options:"TRUE_FALSE"===e.target.value?["True","False"]:["","","",""],correct_answer:""}),className:"w-full px-3 py-2 border rounded-md",required:!0,children:[(0,t.jsx)("option",{value:"MCQ",children:"Multiple Choice"}),(0,t.jsx)("option",{value:"TRUE_FALSE",children:"True/False"}),(0,t.jsx)("option",{value:"FILL_IN_BLANK",children:"Fill in the Blank"}),(0,t.jsx)("option",{value:"SHORT_ANSWER",children:"Short Answer"}),(0,t.jsx)("option",{value:"LONG_ANSWER",children:"Long Answer"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Difficulty *"}),(0,t.jsxs)("select",{value:p.difficulty,onChange:e=>m({...p,difficulty:e.target.value}),className:"w-full px-3 py-2 border rounded-md",required:!0,children:[(0,t.jsx)("option",{value:"easy",children:"Easy"}),(0,t.jsx)("option",{value:"medium",children:"Medium"}),(0,t.jsx)("option",{value:"hard",children:"Hard"})]})]})]}),g&&"MCQ"===p.question_type&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Options *"}),p.options.map((e,s)=>(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,t.jsx)("input",{type:"text",value:e,onChange:e=>{var t;let i;return t=e.target.value,void((i=[...p.options])[s]=t,m({...p,options:i}))},placeholder:`Option ${s+1}`,className:"flex-1 px-3 py-2 border rounded-md"}),p.options.length>2&&(0,t.jsx)("button",{type:"button",onClick:()=>(e=>{if(p.options.length<=2)return void r.toast.error("Must have at least 2 options");let t=p.options.filter((t,s)=>s!==e);m({...p,options:t})})(s),className:"px-3 py-2 text-red-600 hover:bg-red-50 rounded",children:"Remove"})]},s)),p.options.length<6&&(0,t.jsx)("button",{type:"button",onClick:()=>{m({...p,options:[...p.options,""]})},className:"text-sm text-indigo-600 hover:text-indigo-700",children:"+ Add Option"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer *"}),"MCQ"===p.question_type?(0,t.jsxs)("select",{value:p.correct_answer,onChange:e=>m({...p,correct_answer:e.target.value}),className:"w-full px-3 py-2 border rounded-md",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select correct option"}),p.options.filter(e=>e.trim()).map((e,s)=>(0,t.jsx)("option",{value:e,children:e},s))]}):"TRUE_FALSE"===p.question_type?(0,t.jsxs)("select",{value:p.correct_answer,onChange:e=>m({...p,correct_answer:e.target.value}),className:"w-full px-3 py-2 border rounded-md",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select answer"}),(0,t.jsx)("option",{value:"True",children:"True"}),(0,t.jsx)("option",{value:"False",children:"False"})]}):(0,t.jsx)("textarea",{value:p.correct_answer,onChange:e=>m({...p,correct_answer:e.target.value}),rows:"LONG_ANSWER"===p.question_type?4:2,className:"w-full px-3 py-2 border rounded-md",placeholder:"Enter the correct answer",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Explanation (Optional)"}),(0,t.jsx)("textarea",{value:p.explanation,onChange:e=>m({...p,explanation:e.target.value}),rows:2,className:"w-full px-3 py-2 border rounded-md",placeholder:"Provide an explanation for the answer"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Points *"}),(0,t.jsx)("input",{type:"number",min:"1",max:"10",value:p.points,onChange:e=>m({...p,points:parseInt(e.target.value)||1}),className:"w-full px-3 py-2 border rounded-md",required:!0})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[(0,t.jsx)("button",{type:"button",onClick:i,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",disabled:c,children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50",disabled:c,children:c?"Saving...":x?"Update Question":"Create Question"})]})]})]})})}var u=e.i(522016);function x({chapter:e,initialQuestions:a,stats:o}){let[d,x]=(0,s.useState)(a),[p,m]=(0,s.useState)(new Set),[h,g]=(0,s.useState)("all"),[f,v]=(0,s.useState)("all"),[y,b]=(0,s.useState)(""),[j,N]=(0,s.useState)(!1),[w,_]=(0,s.useState)(null),[S,q]=(0,s.useTransition)(),C=(0,i.useRouter)(),E=d.filter(e=>("all"===h||e.difficulty===h)&&("all"===f||e.question_type===f)&&(!y||!!e.question_text.toLowerCase().includes(y.toLowerCase()))),R=async e=>{confirm("Delete this question?")&&q(async()=>{try{await l(e),x(t=>t.filter(t=>t.id!==e)),r.toast.success("Question deleted"),C.refresh()}catch(e){r.toast.error(e.message||"Failed to delete question")}})},A=async()=>{0===p.size?r.toast.error("No questions selected"):confirm(`Delete ${p.size} selected question(s)?`)&&q(async()=>{try{await n(Array.from(p)),x(e=>e.filter(e=>!p.has(e.id))),m(new Set),r.toast.success(`Deleted ${p.size} question(s)`),C.refresh()}catch(e){r.toast.error(e.message||"Failed to delete questions")}})};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[(0,t.jsx)(u.default,{href:"/admin/chapters",className:"hover:text-indigo-600",children:"Chapters"}),(0,t.jsx)("span",{children:"/"}),(0,t.jsx)(u.default,{href:`/admin/chapters/${e.id}`,className:"hover:text-indigo-600",children:e.title}),(0,t.jsx)("span",{children:"/"}),(0,t.jsx)("span",{className:"text-gray-900",children:"Questions"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:e.title}),(0,t.jsxs)("p",{className:"text-gray-600 mt-1",children:[e.subject.name," • ",e.subject.program.name," • ",e.subject.program.board.name]})]}),(0,t.jsx)("button",{onClick:()=>{_(null),N(!0)},className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700",children:"Add New Question"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-indigo-600",children:o.total}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Total Questions"})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:o.byDifficulty.easy||0}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Easy"})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:o.byDifficulty.medium||0}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Medium"})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600",children:o.byDifficulty.hard||0}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Hard"})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:o.byType.MCQ||0}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"MCQs"})]})]}),(0,t.jsx)("div",{className:"bg-white p-4 rounded-lg shadow mb-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)("input",{type:"text",placeholder:"Search questions...",value:y,onChange:e=>b(e.target.value),className:"px-4 py-2 border rounded-md"}),(0,t.jsxs)("select",{value:h,onChange:e=>g(e.target.value),className:"px-4 py-2 border rounded-md",children:[(0,t.jsx)("option",{value:"all",children:"All Difficulties"}),(0,t.jsx)("option",{value:"easy",children:"Easy"}),(0,t.jsx)("option",{value:"medium",children:"Medium"}),(0,t.jsx)("option",{value:"hard",children:"Hard"}),(0,t.jsx)("option",{value:"exam",children:"Exam (Past Papers)"})]}),(0,t.jsxs)("select",{value:f,onChange:e=>v(e.target.value),className:"px-4 py-2 border rounded-md",children:[(0,t.jsx)("option",{value:"all",children:"All Types"}),(0,t.jsx)("option",{value:"MCQ",children:"MCQ"}),(0,t.jsx)("option",{value:"TRUE_FALSE",children:"True/False"}),(0,t.jsx)("option",{value:"FILL_IN_BLANK",children:"Fill in Blank"}),(0,t.jsx)("option",{value:"SHORT_ANSWER",children:"Short Answer"}),(0,t.jsx)("option",{value:"LONG_ANSWER",children:"Long Answer"})]})]})}),p.size>0&&(0,t.jsxs)("div",{className:"mb-4 bg-indigo-50 border border-indigo-200 rounded-lg p-4 flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-sm font-medium text-indigo-900",children:[p.size," question(s) selected"]}),(0,t.jsx)("button",{onClick:A,disabled:S,className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 disabled:opacity-50 text-sm",children:S?"Deleting...":"Delete Selected"})]}),(0,t.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:(0,t.jsxs)("ul",{className:"divide-y divide-gray-200",children:[(0,t.jsx)("li",{className:"bg-gray-50 border-b-2 border-gray-300",children:(0,t.jsxs)("div",{className:"px-4 py-3 flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:p.size===E.length&&E.length>0,onChange:()=>{p.size===E.length?m(new Set):m(new Set(E.map(e=>e.id)))},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,t.jsxs)("label",{className:"ml-3 text-sm font-medium text-gray-700",children:["Select All (",E.length,")"]})]})}),E.map(e=>{var s,i;return(0,t.jsx)("li",{className:"hover:bg-gray-50",children:(0,t.jsxs)("div",{className:"px-4 py-4 flex items-start gap-4",children:[(0,t.jsx)("input",{type:"checkbox",checked:p.has(e.id),onChange:()=>{var t;let s;return t=e.id,void((s=new Set(p)).has(t)?s.delete(t):s.add(t),m(s))},className:"mt-1 h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(s=e.difficulty,(0,t.jsx)("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${{easy:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",hard:"bg-red-100 text-red-800",exam:"bg-purple-100 text-purple-800"}[s]||"bg-gray-100 text-gray-800"}`,children:s.charAt(0).toUpperCase()+s.slice(1)})),(i=e.question_type,(0,t.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded bg-blue-100 text-blue-800",children:{MCQ:"MCQ",TRUE_FALSE:"T/F",FILL_IN_BLANK:"Fill Blank",SHORT_ANSWER:"Short",LONG_ANSWER:"Essay"}[i]})),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:[e.points," pt",1!==e.points?"s":""]})]}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 line-clamp-2",children:e.question_text}),e.explanation&&(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1 line-clamp-1",children:["Explanation: ",e.explanation]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>{_(e),N(!0)},className:"text-indigo-600 hover:text-indigo-900 text-sm",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>R(e.id),disabled:S,className:"text-red-600 hover:text-red-900 text-sm disabled:opacity-50",children:"Delete"})]})]})},e.id)}),0===E.length&&(0,t.jsx)("li",{className:"px-4 py-8 text-center text-gray-500",children:"No questions found. Create one to get started!"})]})}),(0,t.jsx)(c,{isOpen:j,onClose:()=>{N(!1),_(null)},chapterId:e.id,question:w,onSuccess:e=>{w?x(t=>t.map(t=>t.id===e.id?e:t)):x(t=>[e,...t]),N(!1),_(null),C.refresh()}})]})}e.s(["default",()=>x],191002)}]);