(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,531278,e=>{"use strict";let t=(0,e.i(475254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],531278)},515288,e=>{"use strict";var t=e.i(843476),r=e.i(975157);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...a})}function s({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...a})}function n({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",e),...a})}function i({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",e),...a})}function o({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",e),...a})}function l({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,r.cn)("flex items-center px-6 [.border-t]:pt-6",e),...a})}e.s(["Card",()=>a,"CardContent",()=>o,"CardDescription",()=>i,"CardFooter",()=>l,"CardHeader",()=>s,"CardTitle",()=>n])},514764,531245,778917,e=>{"use strict";var t=e.i(475254);let r=(0,t.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>r],514764);let a=(0,t.default)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);e.s(["Bot",()=>a],531245);let s=(0,t.default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);e.s(["ExternalLink",()=>s],778917)},174886,e=>{"use strict";let t=(0,e.i(475254).default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);e.s(["Copy",()=>t],174886)},178583,e=>{"use strict";let t=(0,e.i(475254).default)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["FileText",()=>t],178583)},114683,e=>{"use strict";let t=(0,e.i(475254).default)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Circle",()=>t],114683)},487486,e=>{"use strict";var t=e.i(843476),r=e.i(991918),a=e.i(225913),s=e.i(975157);let n=(0,a.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:a,asChild:i=!1,...o}){let l=i?r.Slot:"span";return(0,t.jsx)(l,{"data-slot":"badge",className:(0,s.cn)(n({variant:a}),e),...o})}e.s(["Badge",()=>i])},296626,e=>{"use strict";var t=e.i(271645),r=e.i(820783),a=e.i(934620),s=e=>{var s;let i,o,{present:l,children:c}=e,d=function(e){var r,s;let[i,o]=t.useState(),l=t.useRef(null),c=t.useRef(e),d=t.useRef("none"),[u,h]=(r=e?"mounted":"unmounted",s={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},t.useReducer((e,t)=>s[e][t]??e,r));return t.useEffect(()=>{let e=n(l.current);d.current="mounted"===u?e:"none"},[u]),(0,a.useLayoutEffect)(()=>{let t=l.current,r=c.current;if(r!==e){let a=d.current,s=n(t);e?h("MOUNT"):"none"===s||t?.display==="none"?h("UNMOUNT"):r&&a!==s?h("ANIMATION_OUT"):h("UNMOUNT"),c.current=e}},[e,h]),(0,a.useLayoutEffect)(()=>{if(i){let e,t=i.ownerDocument.defaultView??window,r=r=>{let a=n(l.current).includes(CSS.escape(r.animationName));if(r.target===i&&a&&(h("ANIMATION_END"),!c.current)){let r=i.style.animationFillMode;i.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===i.style.animationFillMode&&(i.style.animationFillMode=r)})}},a=e=>{e.target===i&&(d.current=n(l.current))};return i.addEventListener("animationstart",a),i.addEventListener("animationcancel",r),i.addEventListener("animationend",r),()=>{t.clearTimeout(e),i.removeEventListener("animationstart",a),i.removeEventListener("animationcancel",r),i.removeEventListener("animationend",r)}}h("ANIMATION_END")},[i,h]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:t.useCallback(e=>{l.current=e?getComputedStyle(e):null,o(e)},[])}}(l),u="function"==typeof c?c({present:d.isPresent}):t.Children.only(c),h=(0,r.useComposedRefs)(d.ref,(s=u,(o=(i=Object.getOwnPropertyDescriptor(s.props,"ref")?.get)&&"isReactWarning"in i&&i.isReactWarning)?s.ref:(o=(i=Object.getOwnPropertyDescriptor(s,"ref")?.get)&&"isReactWarning"in i&&i.isReactWarning)?s.props.ref:s.props.ref||s.ref));return"function"==typeof c||d.isPresent?t.cloneElement(u,{ref:h}):null};function n(e){return e?.animationName||"none"}s.displayName="Presence",e.s(["Presence",()=>s])},842727,e=>{"use strict";var t=e.i(271645);function r(e,t,{checkForDefaultPrevented:a=!0}={}){return function(r){if(e?.(r),!1===a||!r.defaultPrevented)return t?.(r)}}"undefined"!=typeof window&&window.document&&window.document.createElement;var a=e.i(75830),s=e.i(820783),n=e.i(30030),i=e.i(610772),o=e.i(248425),l=e.i(30207),c=e.i(369340),d=e.i(586318),u=e.i(843476),h="rovingFocusGroup.onEntryFocus",m={bubbles:!1,cancelable:!0},x="RovingFocusGroup",[g,f,p]=(0,a.createCollection)(x),[v,y]=(0,n.createContextScope)(x,[p]),[b,w]=v(x),j=t.forwardRef((e,t)=>(0,u.jsx)(g.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,u.jsx)(g.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,u.jsx)(N,{...e,ref:t})})}));j.displayName=x;var N=t.forwardRef((e,a)=>{let{__scopeRovingFocusGroup:n,orientation:i,loop:g=!1,dir:p,currentTabStopId:v,defaultCurrentTabStopId:y,onCurrentTabStopIdChange:w,onEntryFocus:j,preventScrollOnEntryFocus:N=!1,...C}=e,k=t.useRef(null),S=(0,s.useComposedRefs)(a,k),D=(0,d.useDirection)(p),[T,A]=(0,c.useControllableState)({prop:v,defaultProp:y??null,onChange:w,caller:x}),[E,M]=t.useState(!1),P=(0,l.useCallbackRef)(j),I=f(n),R=t.useRef(!1),[O,L]=t.useState(0);return t.useEffect(()=>{let e=k.current;if(e)return e.addEventListener(h,P),()=>e.removeEventListener(h,P)},[P]),(0,u.jsx)(b,{scope:n,orientation:i,dir:D,loop:g,currentTabStopId:T,onItemFocus:t.useCallback(e=>A(e),[A]),onItemShiftTab:t.useCallback(()=>M(!0),[]),onFocusableItemAdd:t.useCallback(()=>L(e=>e+1),[]),onFocusableItemRemove:t.useCallback(()=>L(e=>e-1),[]),children:(0,u.jsx)(o.Primitive.div,{tabIndex:E||0===O?-1:0,"data-orientation":i,...C,ref:S,style:{outline:"none",...e.style},onMouseDown:r(e.onMouseDown,()=>{R.current=!0}),onFocus:r(e.onFocus,e=>{let t=!R.current;if(e.target===e.currentTarget&&t&&!E){let t=new CustomEvent(h,m);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=I().filter(e=>e.focusable);F([e.find(e=>e.active),e.find(e=>e.id===T),...e].filter(Boolean).map(e=>e.ref.current),N)}}R.current=!1}),onBlur:r(e.onBlur,()=>M(!1))})})}),C="RovingFocusGroupItem",k=t.forwardRef((e,a)=>{let{__scopeRovingFocusGroup:s,focusable:n=!0,active:l=!1,tabStopId:c,children:d,...h}=e,m=(0,i.useId)(),x=c||m,p=w(C,s),v=p.currentTabStopId===x,y=f(s),{onFocusableItemAdd:b,onFocusableItemRemove:j,currentTabStopId:N}=p;return t.useEffect(()=>{if(n)return b(),()=>j()},[n,b,j]),(0,u.jsx)(g.ItemSlot,{scope:s,id:x,focusable:n,active:l,children:(0,u.jsx)(o.Primitive.span,{tabIndex:v?0:-1,"data-orientation":p.orientation,...h,ref:a,onMouseDown:r(e.onMouseDown,e=>{n?p.onItemFocus(x):e.preventDefault()}),onFocus:r(e.onFocus,()=>p.onItemFocus(x)),onKeyDown:r(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void p.onItemShiftTab();if(e.target!==e.currentTarget)return;let t=function(e,t,r){var a;let s=(a=e.key,"rtl"!==r?a:"ArrowLeft"===a?"ArrowRight":"ArrowRight"===a?"ArrowLeft":a);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(s))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(s)))return S[s]}(e,p.orientation,p.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let s=y().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)s.reverse();else if("prev"===t||"next"===t){var r,a;"prev"===t&&s.reverse();let n=s.indexOf(e.currentTarget);s=p.loop?(r=s,a=n+1,r.map((e,t)=>r[(a+t)%r.length])):s.slice(n+1)}setTimeout(()=>F(s))}}),children:"function"==typeof d?d({isCurrentTabStop:v,hasTabStop:null!=N}):d})})});k.displayName=C;var S={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function F(e,t=!1){let r=document.activeElement;for(let a of e)if(a===r||(a.focus({preventScroll:t}),document.activeElement!==r))return}e.s(["Item",()=>k,"Root",()=>j,"createRovingFocusGroupScope",()=>y],842727)},192537,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(519455),s=e.i(793479),n=e.i(737345),i=e.i(686311),o=e.i(555436),l=e.i(840433),c=e.i(727612),d=e.i(592930),u=e.i(323585),h=e.i(531278),m=e.i(373375),x=e.i(463059),g=e.i(755146),f=e.i(846696),p=e.i(868499);function v({currentConversationId:e,onSelectConversation:v,onNewConversation:y,refreshTrigger:b,basePath:w="/api/admin/conversations"}){let j,N,C,k,S,[F,D]=(0,r.useState)([]),[T,A]=(0,r.useState)(""),[E,M]=(0,r.useState)(!0),[P,I]=(0,r.useState)(null),[R,O]=(0,r.useState)(""),[L,$]=(0,r.useState)(!1),[z,U]=(0,r.useState)(null),[B,q]=(0,r.useState)(!1),[H,G]=(0,r.useState)(!1),_=async()=>{try{let e=new URLSearchParams;T&&e.append("search",T),T&&e.append("search",T);let t=await fetch(`${w}?${e}`);if(!t.ok)throw Error("Failed to load conversations");let r=await t.json();D(r.conversations||[])}catch(e){console.error("Error loading conversations:",e),f.toast.error("Failed to load conversations")}finally{M(!1)}};(0,r.useEffect)(()=>{_()},[T,b]);let W=async(e,t)=>{try{if(!(await fetch(`${w}/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isPinned:!t})})).ok)throw Error("Failed to update conversation");f.toast.success(t?"Unpinned":"Pinned"),_()}catch(e){console.error("Error toggling pin:",e),f.toast.error("Failed to update conversation")}},K=async t=>{try{if(!(await fetch(`${w}/${t}`,{method:"DELETE"})).ok)throw Error("Failed to delete conversation");f.toast.success("Conversation deleted"),e===t?y():_()}catch(e){console.error("Error deleting conversation:",e),f.toast.error("Failed to delete conversation")}finally{$(!1),U(null)}},V=async(e,t)=>{if(t.trim())try{if(!(await fetch(`${w}/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t.trim()})})).ok)throw Error("Failed to rename conversation");f.toast.success("Renamed"),_()}catch(e){console.error("Error renaming conversation:",e),f.toast.error("Failed to rename conversation")}finally{I(null),O("")}},J=async()=>{try{let t=await fetch(w,{method:"DELETE"});if(!t.ok)throw Error("Failed to delete all conversations");let r=await t.json();f.toast.success(r.message||"All conversations deleted"),e&&y(),_()}catch(e){console.error("Error deleting all conversations:",e),f.toast.error("Failed to delete all conversations")}finally{q(!1)}},Z=((C=new Date(N=new Date((j=new Date).getFullYear(),j.getMonth(),j.getDate()))).setDate(C.getDate()-1),(k=new Date(N)).setDate(k.getDate()-7),S=[{label:"Pinned",conversations:[]},{label:"Today",conversations:[]},{label:"Yesterday",conversations:[]},{label:"Last 7 Days",conversations:[]},{label:"Older",conversations:[]}],F.forEach(e=>{if(e.isPinned)return void S[0].conversations.push(e);let t=new Date(e.lastMessageAt||e.updatedAt);t>=N?S[1].conversations.push(e):t>=C?S[2].conversations.push(e):t>=k?S[3].conversations.push(e):S[4].conversations.push(e)}),S.filter(e=>e.conversations.length>0));return(0,t.jsxs)("div",{className:`bg-white border-r border-gray-200 flex flex-col h-full transition-all duration-300 ease-in-out relative ${H?"w-16":"w-64"}`,children:[(0,t.jsx)("button",{onClick:()=>G(!H),className:"absolute -right-3 top-8 z-10 bg-white border border-gray-200 rounded-full p-1 hover:bg-gray-50 shadow-sm",title:H?"Expand sidebar":"Collapse sidebar",children:H?(0,t.jsx)(x.ChevronRight,{className:"h-4 w-4 text-gray-600"}):(0,t.jsx)(m.ChevronLeft,{className:"h-4 w-4 text-gray-600"})}),(0,t.jsx)("div",{className:`p-4 border-b border-gray-200 ${H?"px-2":""}`,children:(0,t.jsxs)(a.Button,{onClick:y,className:`w-full ${H?"px-2":""}`,variant:"default",title:H?"New Chat":"",children:[(0,t.jsx)(n.MessageSquarePlus,{className:`h-4 w-4 ${H?"":"mr-2"}`}),!H&&"New Chat"]})}),!H&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"p-3 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(o.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-white"}),(0,t.jsx)(s.Input,{type:"text",placeholder:"Search conversations...",value:T,onChange:e=>A(e.target.value),className:"pl-9 h-9"})]})}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto",children:E?(0,t.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,t.jsx)(h.Loader2,{className:"h-6 w-6 animate-spin text-gray-400"})}):0===Z.length?(0,t.jsxs)("div",{className:"p-4 text-center text-gray-500 text-sm",children:["No conversations yet.",(0,t.jsx)("br",{}),"Start chatting to create one!"]}):Z.map(r=>(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("div",{className:"px-3 py-2 text-xs font-semibold text-gray-500 uppercase",children:r.label}),(0,t.jsx)("div",{className:"space-y-1",children:r.conversations.map(r=>(0,t.jsx)("div",{className:`group relative mx-2 rounded-lg transition-colors ${e===r.id?"bg-blue-50 border border-blue-200":"hover:bg-gray-50 border border-transparent"}`,children:P===r.id?(0,t.jsx)("div",{className:"p-2",children:(0,t.jsx)(s.Input,{value:R,onChange:e=>O(e.target.value),onBlur:()=>V(r.id,R),onKeyDown:e=>{"Enter"===e.key?V(r.id,R):"Escape"===e.key&&(I(null),O(""))},autoFocus:!0,className:"h-8 text-sm"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>v(r.id),className:"w-full text-left p-2 pr-8",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[r.isPinned&&(0,t.jsx)(l.Pin,{className:"h-3 w-3 text-blue-500 mt-1 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:r.title}),r.lastMessage&&(0,t.jsx)("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:r.lastMessage}),(0,t.jsxs)("div",{className:"text-xs text-gray-400 mt-0.5",children:[r.messageCount," ",1===r.messageCount?"message":"messages"]})]})]})}),(0,t.jsx)("div",{className:"absolute right-1 top-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsxs)(g.DropdownMenu,{children:[(0,t.jsx)(g.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(a.Button,{variant:"ghost",size:"icon",className:"h-7 w-7",children:(0,t.jsx)(u.MoreVertical,{className:"h-3.5 w-3.5"})})}),(0,t.jsxs)(g.DropdownMenuContent,{align:"end",children:[(0,t.jsxs)(g.DropdownMenuItem,{onClick:()=>{I(r.id),O(r.title)},children:[(0,t.jsx)(d.Edit2,{className:"h-3.5 w-3.5 mr-2"}),"Rename"]}),(0,t.jsxs)(g.DropdownMenuItem,{onClick:()=>W(r.id,r.isPinned),children:[(0,t.jsx)(l.Pin,{className:"h-3.5 w-3.5 mr-2"}),r.isPinned?"Unpin":"Pin"]}),(0,t.jsxs)(g.DropdownMenuItem,{onClick:()=>{U(r.id),$(!0)},className:"text-red-600",children:[(0,t.jsx)(c.Trash2,{className:"h-3.5 w-3.5 mr-2"}),"Delete"]})]})]})})]})},r.id))})]},r.label))})]}),H&&(0,t.jsx)("div",{className:"flex-1 flex flex-col items-center py-4 gap-3 overflow-y-auto",children:F.slice(0,10).map(r=>(0,t.jsx)("button",{onClick:()=>v(r.id),className:`w-10 h-10 rounded-lg flex items-center justify-center transition-colors ${e===r.id?"bg-blue-100 text-blue-600":"hover:bg-gray-100 text-gray-600"}`,title:r.title,children:(0,t.jsx)(i.MessageSquare,{className:"h-5 w-5"})},r.id))}),!H&&F.length>0&&(0,t.jsx)("div",{className:"border-t border-gray-200 p-3",children:(0,t.jsxs)(a.Button,{variant:"outline",className:"w-full text-red-600 hover:text-red-700 hover:bg-red-50 border-red-200",onClick:()=>q(!0),children:[(0,t.jsx)(c.Trash2,{className:"h-4 w-4 mr-2"}),"Clear All Conversations"]})}),(0,t.jsx)(p.AlertDialog,{open:B,onOpenChange:q,children:(0,t.jsxs)(p.AlertDialogContent,{children:[(0,t.jsxs)(p.AlertDialogHeader,{children:[(0,t.jsx)(p.AlertDialogTitle,{children:"Delete All Conversations?"}),(0,t.jsxs)(p.AlertDialogDescription,{children:["This will permanently delete all ",F.length," ","conversation",1!==F.length?"s":""," and all their messages. This action cannot be undone."]})]}),(0,t.jsxs)(p.AlertDialogFooter,{children:[(0,t.jsx)(p.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(p.AlertDialogAction,{onClick:J,className:"bg-red-600 hover:bg-red-700",children:"Delete All"})]})]})}),(0,t.jsx)(p.AlertDialog,{open:L,onOpenChange:$,children:(0,t.jsxs)(p.AlertDialogContent,{children:[(0,t.jsxs)(p.AlertDialogHeader,{children:[(0,t.jsx)(p.AlertDialogTitle,{children:"Delete Conversation?"}),(0,t.jsx)(p.AlertDialogDescription,{children:"This will permanently delete the conversation and all its messages. This action cannot be undone."})]}),(0,t.jsxs)(p.AlertDialogFooter,{children:[(0,t.jsx)(p.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(p.AlertDialogAction,{onClick:()=>z&&K(z),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})}e.s(["default",()=>v])},884348,e=>{"use strict";var t=e.i(843476),r=e.i(271645),a=e.i(522016),s=e.i(519455),n=e.i(793479),i=e.i(515288),o=e.i(487486),l=e.i(225913),c=e.i(975157);let d=(0,l.cva)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),u=r.forwardRef(({className:e,variant:r,...a},s)=>(0,t.jsx)("div",{ref:s,role:"alert",className:(0,c.cn)(d({variant:r}),e),...a}));u.displayName="Alert",r.forwardRef(({className:e,...r},a)=>(0,t.jsx)("h5",{ref:a,className:(0,c.cn)("mb-1 font-medium leading-none tracking-tight",e),...r})).displayName="AlertTitle";let h=r.forwardRef(({className:e,...r},a)=>(0,t.jsx)("div",{ref:a,className:(0,c.cn)("text-sm [&_p]:leading-relaxed",e),...r}));h.displayName="AlertDescription";var m=e.i(531278),x=e.i(514764),g=e.i(531245),f=e.i(284614),p=e.i(178583),v=e.i(63209),y=e.i(686311),b=e.i(778917),w=e.i(174886),j=e.i(643531);let N=(0,e.i(475254).default)("file-down",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);var C=e.i(846696),k=e.i(918789),S=e.i(742531),F=e.i(192537);function D(){let[l,c]=(0,r.useState)([]),[d,D]=(0,r.useState)(""),[T,A]=(0,r.useState)(!1),[E,M]=(0,r.useState)(null),[P,I]=(0,r.useState)(null),[R,O]=(0,r.useState)("New Conversation"),[L,$]=(0,r.useState)(0),[z,U]=(0,r.useState)("gemini-2.5-pro"),[B,q]=(0,r.useState)([{name:"gemini-2.5-pro",label:"Gemini 2.5 Pro"},{name:"gemini-2.5-flash",label:"Gemini 2.5 Flash"}]),[H,G]=(0,r.useState)(!1),[_,W]=(0,r.useState)(null),[K,V]=(0,r.useState)(null),[J,Z]=(0,r.useState)({}),[Y,Q]=(0,r.useState)([]),[X,ee]=(0,r.useState)(!1),[et,er]=(0,r.useState)("");(0,r.useEffect)(()=>{let e=!1;return async function(){try{G(!0);let t=await fetch("/api/admin/ai/models?provider=gemini");if(!t.ok)throw Error("Failed to load models");let r=await t.json();if(e)return;let a=Array.isArray(r.models)?r.models:[],s=a.length>0?a:[{name:"gemini-2.5-pro",label:"Gemini 2.5 Pro"},{name:"gemini-2.5-flash",label:"Gemini 2.5 Flash"}];q(s),s.length>0&&!s.some(e=>e.name===z)&&U(s[0].name)}catch(t){if(console.error("[AdminChat] Failed to fetch models",t),!e){let e=[{name:"gemini-2.5-pro",label:"Gemini 2.5 Pro"},{name:"gemini-2.5-flash",label:"Gemini 2.5 Flash"}];q(e),e.some(e=>e.name===z)||U(e[0].name)}}finally{e||G(!1)}}(),()=>{e=!0}},[z]),(0,r.useEffect)(()=>{!async function(){try{ee(!0);let e=await fetch("/api/admin/categories");if(!e.ok)throw Error("Failed to load categories");let t=await e.json();Q(t.categories||[]),et&&!t.categories?.includes(et)&&er("")}catch(e){console.error("[AdminChat] Failed to fetch categories",e),Q([])}finally{ee(!1)}}()},[]);let ea=(0,r.useRef)(null),es=(0,r.useRef)(null);(0,r.useEffect)(()=>{ea.current&&ea.current.scrollTo({top:ea.current.scrollHeight,behavior:"smooth"})},[l]);let en=async e=>{try{let t,r=e?((t=(t=e.trim()).replace(/^(show|list|find|get|tell|what|who|when|where|how|can you|please)\s+/i,"")).length>50&&(t=t.substring(0,47)+"..."),t.length>0&&(t=t.charAt(0).toUpperCase()+t.slice(1)),t||"New Conversation"):"New Conversation",a=await fetch("/api/admin/conversations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:r})});if(!a.ok)throw Error("Failed to create conversation");return(await a.json()).conversation.id}catch(e){throw console.error("Error creating conversation:",e),C.toast.error("Failed to create conversation"),e}},ei=async(e,t)=>{try{if(!(await fetch(`/api/admin/conversations/${e}/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to save message")}catch(e){console.error("Error saving message:",e)}},eo=async e=>{try{let t=await fetch(`/api/admin/conversations/${e}`);if(!t.ok)throw Error("Failed to load conversation");let r=(await t.json()).conversation;I(r.id),O(r.title);let a=r.messages.map(e=>({id:e.id.toString(),role:e.role,content:e.content,timestamp:new Date(e.timestamp),sources:e.sources||[],tokenCount:e.tokenCount,filters:"assistant"===e.role?e.metadata?.filters||{category:"All Categories"}:void 0}));c(a),M(null),C.toast.success(`Loaded: ${r.title}`)}catch(e){console.error("Error loading conversation:",e),C.toast.error("Failed to load conversation")}},el=async()=>{if(!d.trim()||T)return;let e={id:`user_${Date.now()}`,role:"user",content:d.trim(),timestamp:new Date};c(t=>[...t,e]),D(""),A(!0),M(null);let t=P;if(!t)try{t=await en(e.content),I(t),$(e=>e+1)}catch(e){console.error("Failed to create conversation:",e)}t&&(await ei(t,{role:"user",content:e.content}),$(e=>e+1));let r=`assistant_${Date.now()}`,a={id:r,role:"assistant",content:"Analyzing your question and searching database...",timestamp:new Date,sources:[],filters:{category:et||"All Categories"}};c(e=>[...e,a]);try{let a=await fetch("/api/admin/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e.content,conversationHistory:l,provider:"gemini",model:z,category:et||void 0,stream:!0})});if(!a.ok){let e=a.headers.get("content-type");if(e&&-1!==e.indexOf("application/json")){let e=await a.json();if(429===a.status){C.toast.error(e.error||"You are making requests too quickly. Please wait and try again."),c(e=>e.filter(e=>e.id!==r));return}throw Error(e.error||"An unknown error occurred")}{let e=await a.text();console.error("Received non-JSON error response:",e);let t="The server returned an unexpected response";throw e.includes("504 Gateway Time-out")?t="Server timeout. Please try again later.":e.includes("502 Bad Gateway")?t="Server error. Please try again later.":e.includes("500 Internal Server Error")&&(t="Internal server error. Please try again later."),C.toast.error(t),Error(t)}}let s=a.body?.getReader(),n=new TextDecoder,i="",o={},d=!0,u=[],h=null;if(!s)throw Error("Failed to get response reader");for(;;){let{done:e,value:t}=await s.read();if(e)break;for(let e of n.decode(t,{stream:!0}).split("\n"))if(e.startsWith("data: "))try{let t=JSON.parse(e.slice(6));if("metadata"===t.type)o=t,W({queryType:t.queryType,searchQuery:t.searchQuery,analysisUsed:t.analysisUsed});else if("progress"===t.type)c(e=>e.map(e=>e.id===r?{...e,content:t.progress||"Processing..."}:e));else if("token"===t.type)d?(d=!1,i=t.text||""):i+=t.text||"",c(e=>e.map(e=>e.id===r?{...e,content:i}:e));else if("sources"===t.type)u=t.sources||[],c(e=>e.map(e=>e.id===r?{...e,sources:u}:e));else if("done"===t.type)h=t.tokenCount,c(e=>e.map(e=>e.id===r?{...e,tokenCount:h}:e));else if("error"===t.type)throw Error(t.error||"Streaming error occurred")}catch(e){console.error("Error parsing SSE data:",e)}}if(!i)throw Error("No response received from server");t&&(await ei(t,{role:"assistant",content:i,sources:u,tokenCount:h,metadata:{queryType:o.queryType,searchMethod:o.searchMethod,analysisUsed:o.analysisUsed,filters:{category:et||"All Categories"}}}),$(e=>e+1))}catch(a){console.error("Chat error:",a);let e=a instanceof Error?a.message:"An unexpected error occurred";M(e);let t=`I apologize, but I encountered an error: ${e}. Please try again.`;c(e=>e.map(e=>e.id===r?{...e,content:t}:e))}finally{A(!1)}},ec=async(e,t)=>{if(e)try{await navigator.clipboard.writeText(e),V(t),setTimeout(()=>{V(null)},2e3)}catch(e){console.error("Failed to copy text: ",e)}},ed=async t=>{if(t)try{let r=new(await e.A(234162)).default,a=r.internal.pageSize.getWidth(),s=r.internal.pageSize.getHeight(),n=20,i=a-2*n,o=n,l=(e=10)=>{o+e>s-n&&(r.addPage(),o=n)},c=(e,t=12,a=!1,s=!1)=>{for(let c of(r.setFontSize(t),a&&s?r.setFont("helvetica","bolditalic"):a?r.setFont("helvetica","bold"):s?r.setFont("helvetica","italic"):r.setFont("helvetica","normal"),r.splitTextToSize(e,i)))l(),r.text(c,n,o),o+=.6*t},d=e=>{if(e.length<2)return;let t=[];for(let r of e)if(r.includes("|")){let e=r.split("|").map(e=>e.trim()).filter(e=>e.length>0);if(e.every(e=>/^:?-+:?$/.test(e)))continue;t.push(e)}if(0===t.length)return;let a=Math.max(...t.map(e=>e.length)),s=(i-10)/a;if(o+=5,l(8*t.length+20),t.length>0){r.setFillColor(240,240,240),r.rect(n,o-5,i,10,"F"),r.setFont("helvetica","bold"),r.setFontSize(10);for(let e=0;e<t[0].length;e++){let a=n+e*s+2;r.text(t[0][e],a,o)}o+=8}r.setFont("helvetica","normal");for(let e=1;e<t.length;e++){l(10),e%2==0&&(r.setFillColor(250,250,250),r.rect(n,o-5,i,8,"F"));let a=t[e];for(let e=0;e<a.length;e++){let t=n+e*s+2,i=a[e],c=r.splitTextToSize(i,s-4);for(let e=0;e<c.length;e++)e>0&&(o+=6,l(10)),r.text(c[e],t,o)}o+=8}let c=8*t.length+3;r.setDrawColor(200,200,200),r.setLineWidth(.5),r.rect(n,o-c,i,c);for(let e=1;e<a;e++){let t=n+e*s;r.line(t,o-c,t,o)}o+=5},u=(e,t=n)=>{let a;if(!e.trim())return;let s=/\*\*(.*?)\*\*/g,c=[],d=0;for(;null!==(a=s.exec(e));)a.index>d&&c.push({text:e.substring(d,a.index),bold:!1,italic:!1,code:!1}),c.push({text:a[1],bold:!0,italic:!1,code:!1}),d=a.index+a[0].length;d<e.length&&c.push({text:e.substring(d),bold:!1,italic:!1,code:!1}),0===c.length&&(c=[{text:e,bold:!1,italic:!1,code:!1}]);let u=t;for(let e of(l(),c)){if(!e.text)continue;e.bold?r.setFont("helvetica","bold"):e.code?r.setFont("courier","normal"):r.setFont("helvetica","normal"),r.setFontSize(12);let t=r.splitTextToSize(e.text,i-(u-n));for(let e=0;e<t.length;e++)e>0&&(o+=7,l(),u=n),r.text(t[e],u,o),e===t.length-1&&(u+=r.getTextWidth(t[e]))}o+=7};r.setFontSize(16),r.setFont("helvetica","bold"),r.text("Zirna Response",n,o),o+=15,r.setFontSize(10),r.setFont("helvetica","normal"),r.text(`Generated: ${new Date().toLocaleString()}`,n,o),o+=20,(e=>{let t=e.split("\n"),a=!1,s=!1,i=[];for(let e=0;e<t.length;e++){let h=t[e];if(h.includes("|")&&!a){s?i.push(h):(s=!0,i=[h]),e!==t.length-1&&t[e+1].includes("|")||(d(i),s=!1,i=[]);continue}if(s&&!h.includes("|")&&(d(i),s=!1,i=[]),h.startsWith("```")){(a=!a)||(o+=5);continue}if(a){r.setFont("courier","normal"),r.setFontSize(10),l(),r.text(h,n+10,o),o+=12;continue}if(h.startsWith("# ")){o+=10,c(h.substring(2),18,!0),o+=5;continue}if(h.startsWith("## ")){o+=8,c(h.substring(3),16,!0),o+=4;continue}if(h.startsWith("### ")){o+=6,c(h.substring(4),14,!0),o+=3;continue}if(h.match(/^[\s]*[-*+]\s/)){let e=2*(h.match(/^(\s*)/)?.[1]?.length||0),t=h.replace(/^[\s]*[-*+]\s/,"");l(),r.setFont("helvetica","normal"),r.setFontSize(12),r.text("•",n+e,o),u(t,n+e+10);continue}if(h.match(/^[\s]*\d+\.\s/)){let e=2*(h.match(/^(\s*)/)?.[1]?.length||0),t=h.match(/^[\s]*(\d+)\.\s(.*)$/);if(t){let a=t[1],s=t[2];l(),r.setFont("helvetica","normal"),r.setFontSize(12),r.text(`${a}.`,n+e,o),u(s,n+e+15);continue}}if(""===h.trim()){o+=6;continue}u(h)}})(t);let h=`cid-ai-response-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.pdf`;r.save(h)}catch(e){console.error("Failed to export PDF:",e),alert("Failed to export PDF. Please try again.")}};return(0,t.jsxs)("div",{className:"flex h-full",children:[(0,t.jsx)(F.default,{currentConversationId:P,onSelectConversation:eo,onNewConversation:()=>{I(null),O("New Conversation"),c([]),M(null),W(null),D(""),C.toast.success("Started new conversation")},refreshTrigger:L}),(0,t.jsxs)("div",{className:"flex-1 p-2 overflow-hidden",children:[E&&(0,t.jsxs)(u,{className:"mb-4",variant:"destructive",children:[(0,t.jsx)(v.AlertCircle,{className:"h-4 w-4"}),(0,t.jsx)(h,{children:E})]}),(0,t.jsxs)(i.Card,{className:"h-[calc(100vh-24px)] flex flex-col",children:[(0,t.jsx)(i.CardHeader,{className:"pb-4 flex-shrink-0",children:(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(i.CardTitle,{className:"flex items-center gap-2 whitespace-nowrap",children:[(0,t.jsx)(y.MessageSquare,{className:"h-5 w-5"}),"Chat History"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{htmlFor:"model",className:"text-sm text-gray-600 whitespace-nowrap",children:"AI Model:"}),(0,t.jsxs)("select",{id:"model",className:"h-9 w-48 rounded-md border border-gray-300 bg-white px-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",value:z,onChange:e=>U(e.target.value),children:[H&&(0,t.jsx)("option",{children:"Loading models..."}),!H&&0===B.length&&(0,t.jsx)("option",{children:"No models configured"}),!H&&B.map(e=>(0,t.jsx)("option",{value:e.name,children:e.label||e.name},e.name))]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{htmlFor:"category",className:"text-sm text-gray-600 whitespace-nowrap",children:"Category:"}),(0,t.jsxs)("select",{id:"category",className:"h-9 rounded-md border border-gray-300 bg-white px-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",value:et,onChange:e=>er(e.target.value),disabled:X,children:[(0,t.jsx)("option",{value:"",children:"All Categories"}),X&&(0,t.jsx)("option",{children:"Loading categories..."}),!X&&0===Y.length&&(0,t.jsx)("option",{children:"No categories found"}),!X&&Y.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]})]}),l.length>0&&(0,t.jsx)(s.Button,{variant:"outline",size:"sm",onClick:()=>{c([]),M(null),Z({})},children:"Clear Chat"})]})}),(0,t.jsxs)(i.CardContent,{className:"flex-1 flex flex-col p-0 min-h-0",children:[(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-4 scroll-smooth",ref:ea,style:{scrollBehavior:"smooth"},children:0===l.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 space-y-4",children:[(0,t.jsx)(g.Bot,{className:"h-12 w-12"}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-lg font-medium",children:"Welcome to Zirna Assistant"}),(0,t.jsx)("p",{className:"text-sm",children:"Ask me anything about the database records"})]})]}):(0,t.jsx)("div",{className:"space-y-4",children:l.map(e=>{var r;return(0,t.jsx)("div",{className:`flex gap-3 ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,t.jsxs)("div",{className:`flex gap-3 max-w-[90%] ${"user"===e.role?"flex-row-reverse":"flex-row"}`,children:[(0,t.jsx)("div",{className:`flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-full ${"user"===e.role?"bg-blue-500 text-white":"bg-gray-200 text-gray-700"}`,children:"user"===e.role?(0,t.jsx)(f.User,{className:"h-4 w-4"}):(0,t.jsx)(g.Bot,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:`rounded-lg px-4 py-2 break-words ${"user"===e.role?"bg-blue-500 text-white":"bg-gray-100 text-gray-900"}`,children:[(0,t.jsx)("div",{className:"text-sm break-words prose prose-sm max-w-none",children:"assistant"===e.role?(0,t.jsx)(t.Fragment,{children:e.content.includes("Analyzing your question")||e.content.includes("Generating response")||e.content.includes("Processing")||e.content.includes("Synthesizing")?(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,t.jsx)(m.Loader2,{className:"h-4 w-4 animate-spin"}),(0,t.jsx)("span",{children:e.content})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.default,{remarkPlugins:[S.default],components:{p:({children:e})=>(0,t.jsx)("p",{className:"mb-2 last:mb-0 break-words leading-relaxed",children:e}),ul:({children:e})=>(0,t.jsx)("ul",{className:"list-disc list-outside ml-4 mb-2 space-y-1",children:e}),ol:({children:e})=>(0,t.jsx)("ol",{className:"list-decimal list-outside ml-4 mb-2 space-y-1",children:e}),li:({children:e})=>(0,t.jsx)("li",{className:"leading-relaxed",children:e}),strong:({children:e})=>(0,t.jsx)("strong",{className:"font-bold text-gray-900",children:e}),em:({children:e})=>(0,t.jsx)("em",{className:"italic",children:e}),code:({children:e})=>(0,t.jsx)("code",{className:"bg-gray-200 px-1 py-0.5 rounded text-xs font-mono",children:e}),h1:({children:e})=>(0,t.jsx)("h1",{className:"text-lg font-bold mb-3 mt-4 first:mt-0 text-gray-900",children:e}),h2:({children:e})=>(0,t.jsx)("h2",{className:"text-base font-bold mb-2 mt-3 first:mt-0 text-gray-900",children:e}),h3:({children:e})=>(0,t.jsx)("h3",{className:"text-sm font-bold mb-2 mt-2 first:mt-0 text-gray-900",children:e}),table:({children:e})=>(0,t.jsx)("div",{className:"overflow-x-auto my-4",children:(0,t.jsx)("table",{className:"min-w-full border-collapse border border-gray-300 text-sm",children:e})}),thead:({children:e})=>(0,t.jsx)("thead",{className:"bg-gray-50",children:e}),tbody:({children:e})=>(0,t.jsx)("tbody",{className:"bg-white",children:e}),tr:({children:e})=>(0,t.jsx)("tr",{className:"border-b border-gray-200",children:e}),th:({children:e})=>(0,t.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left font-semibold text-gray-900 bg-gray-50",children:e}),td:({children:e})=>(0,t.jsx)("td",{className:"border border-gray-300 px-4 py-2 text-gray-700",children:e})},children:e.content}),(0,t.jsxs)("div",{className:"flex items-center gap-1 mt-2",children:[(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>ec(e.content,e.id),title:"Copy to clipboard",children:K===e.id?(0,t.jsx)(j.Check,{className:"h-3.5 w-3.5 text-green-500"}):(0,t.jsx)(w.Copy,{className:"h-3.5 w-3.5"})}),(0,t.jsx)(s.Button,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:async()=>await ed(e.content),title:"Download as PDF",children:(0,t.jsx)(N,{className:"h-3.5 w-3.5"})})]})]})}):(0,t.jsx)("div",{className:"whitespace-pre-wrap",children:e.content})}),(0,t.jsxs)("div",{className:`text-xs mt-1 flex items-center gap-2 ${"user"===e.role?"text-blue-100":"text-gray-500"}`,children:[(0,t.jsx)("span",{children:(r=e.timestamp)?new Date(r).toLocaleString():""}),"assistant"===e.role&&e.tokenCount&&(0,t.jsxs)("span",{className:"border-l border-gray-300 dark:border-gray-700 pl-2 flex items-center",children:[(0,t.jsxs)("span",{title:"Input tokens",children:["In:"," ",e.tokenCount.input.toLocaleString()]}),(0,t.jsx)("span",{className:"mx-1",children:"|"}),(0,t.jsxs)("span",{title:"Output tokens",children:["Out:"," ",e.tokenCount.output.toLocaleString()]})]})]}),"assistant"===e.role&&e.filters&&(0,t.jsx)("div",{className:"mt-2 flex flex-wrap gap-2 text-xs",children:(0,t.jsxs)("div",{className:"inline-flex items-center gap-1 bg-gray-100 text-gray-700 border border-gray-300 px-2 py-1 rounded",children:[(0,t.jsx)("span",{className:"font-medium",children:"Category:"}),(0,t.jsx)("span",{children:e.filters.category||"All Categories"})]})}),e.sources&&e.sources.length>0&&(0,t.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,t.jsxs)("div",{className:"text-xs font-medium text-gray-600",children:["Sources (",e.sources.length,"):"]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(J[e.id]?e.sources:e.sources.slice(0,15)).map((e,r)=>(0,t.jsx)(a.default,{href:`/admin/files/${e.id}`,target:"_blank",rel:"noopener noreferrer",className:"inline-block",title:e.title,children:(0,t.jsxs)(o.Badge,{variant:"secondary",className:"text-xs hover:bg-blue-100 hover:text-blue-800 transition-colors cursor-pointer group max-w-xs",children:[(0,t.jsx)(p.FileText,{className:"h-3 w-3 mr-1 flex-shrink-0"}),(0,t.jsx)("span",{className:"truncate",children:((e,t=40)=>e.length<=t?e:e.substring(0,t).trim()+"...")(e.title,35)}),(0,t.jsx)(b.ExternalLink,{className:"h-3 w-3 ml-1 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]})},`${e.id}-${r}`)),e.sources.length>15&&(0,t.jsx)(s.Button,{variant:"ghost",size:"sm",onClick:()=>{var t;return t=e.id,void Z(e=>({...e,[t]:!e[t]}))},className:"text-xs text-blue-600 hover:text-blue-800 py-1 h-auto",children:J[e.id]?"Show less":`Show ${e.sources.length-15} more...`})]})]})]})]})},e.id)})})}),(0,t.jsxs)("div",{className:"border-t p-4 flex-shrink-0",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.Input,{ref:es,value:d,onChange:e=>D(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),el())},placeholder:"Ask about Zirna database records...",disabled:T,className:"flex-1",maxLength:1e3}),(0,t.jsx)(s.Button,{onClick:el,disabled:!d.trim()||T,size:"icon",children:T?(0,t.jsx)(m.Loader2,{className:"h-4 w-4 animate-spin"}):(0,t.jsx)(x.Send,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center text-xs text-gray-500 mt-2",children:[(0,t.jsxs)("span",{children:[d.length,"/1000 characters"]}),_&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(o.Badge,{variant:"outline",className:"text-xs",children:["Type: ",_.queryType]}),_.analysisUsed&&(0,t.jsx)(o.Badge,{variant:"outline",className:"text-xs bg-green-50",children:"AI Analysis ✓"})]})]})]})]})]})]})]})}e.s(["default",()=>D],884348)},234162,e=>{e.v(t=>Promise.all(["static/chunks/fc3f648b0144df31.js","static/chunks/86f710e2221327ab.js"].map(t=>e.l(t))).then(()=>t(255749)))}]);