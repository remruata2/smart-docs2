module.exports=[121741,278052,t=>{"use strict";let e=Symbol.for("constructDateFrom");function a(t,a){var n;return n=a||t,"function"==typeof n?n(t):n&&"object"==typeof n&&e in n?n[e](t):n instanceof Date?new n.constructor(t):new Date(t)}function n(t,e){let n=a(t,e?.in);return n.setDate(1),n.setHours(0,0,0,0),n}function r(t,e){let n=a(t,e?.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}t.s(["startOfMonth",()=>n],121741),t.s(["endOfMonth",()=>r],278052)},237295,t=>{"use strict";var e=t.i(843793),a=t.i(660724),n=t.i(121741),r=t.i(278052);async function i(t,s,o=1,u){let d=new Date,c=(0,n.startOfMonth)(d),f=(0,r.endOfMonth)(d),g=await e.db.usageTracking.findFirst({where:{user_id:t,usage_type:s,period_start:c,period_end:f}});return g?await e.db.usageTracking.update({where:{id:g.id},data:{count:g.count+o,metadata:u?{...g.metadata,...u}:null===g.metadata?a.Prisma.JsonNull:g.metadata}}):await e.db.usageTracking.create({data:{user_id:t,usage_type:s,count:o,period_start:c,period_end:f,metadata:u||{}}})}async function s(t,a){let i=new Date,s=(0,n.startOfMonth)(i),o=(0,r.endOfMonth)(i),u=await e.db.usageTracking.findFirst({where:{user_id:t,usage_type:a,period_start:s,period_end:o}});return u?.count||0}async function o(t){let a=new Date,i=(0,n.startOfMonth)(a),s=(0,r.endOfMonth)(a),o=await e.db.usageTracking.findMany({where:{user_id:t,period_start:i,period_end:s}}),u={file_upload:0,chat_message:0,document_export:0,ai_processing:0,quiz_generation:0,battle_match:0,ai_tutor_session:0};return o.forEach(t=>{u[t.usage_type]=t.count}),u}async function u(t,e,a){return await s(t,e)>=a}async function d(t,e,a){return!await u(t,e,a)}async function c(t){let a=new Date,i=(0,n.startOfMonth)(a),s=(0,r.endOfMonth)(a);return await e.db.usageTracking.findMany({where:{user_id:t,period_start:{gte:i,lte:s}},orderBy:{created_at:"desc"}})}t.s(["canPerformAction",()=>d,"getAllCurrentUsage",()=>o,"getCurrentUsage",()=>s,"getUserUsageStats",()=>c,"hasExceededLimit",()=>u,"trackUsage",()=>i])}];

//# sourceMappingURL=_0da11c72._.js.map