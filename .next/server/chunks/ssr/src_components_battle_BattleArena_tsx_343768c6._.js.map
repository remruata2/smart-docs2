{"version":3,"sources":["../../../../src/components/battle/BattleArena.tsx","../../../../src/components/battle/BattleResult.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect, useRef } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { Button } from \"@/components/ui/button\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { toast } from \"sonner\";\nimport { Loader2, Trophy, Clock, Users, Copy, Swords, LogOut } from \"lucide-react\";\nimport { QuestionCard } from \"@/components/practice/QuestionCard\";\nimport { createClient } from \"@supabase/supabase-js\";\n\nimport { BattleResult } from \"@/components/battle/BattleResult\";\n\ninterface BattleArenaProps {\n    battle: any;\n    currentUser: any;\n    supabaseConfig: {\n        url: string;\n        anonKey: string;\n    };\n}\n\nexport function BattleArena({ battle: initialBattle, currentUser, supabaseConfig }: BattleArenaProps) {\n    // Opponent state (derived early for initialization)\n    const initialMyParticipant = initialBattle.participants.find((p: any) => p.user_id === currentUser.id);\n\n    const router = useRouter();\n    const [battle, setBattle] = useState(initialBattle);\n    // Initialize currentQIndex from saved progress if available\n    const [currentQIndex, setCurrentQIndex] = useState(initialMyParticipant?.current_q_index || 0);\n    const [selectedAnswer, setSelectedAnswer] = useState<any>(null);\n    const [waiting, setWaiting] = useState(initialBattle.status === \"WAITING\");\n    const [timeLeft, setTimeLeft] = useState(15); // Default 15s per question\n    const [submitting, setSubmitting] = useState(false);\n    const [supabase, setSupabase] = useState<any>(null);\n\n    // Initialize Supabase client\n    useEffect(() => {\n        if (supabaseConfig.url && supabaseConfig.anonKey) {\n            setSupabase(createClient(supabaseConfig.url, supabaseConfig.anonKey));\n        }\n    }, [supabaseConfig]);\n\n    // Refs to track latest state for intervals/callbacks\n    const battleRef = useRef(battle);\n    const isLeavingRef = useRef(false);\n    useEffect(() => { battleRef.current = battle; }, [battle]);\n\n    // Derived state\n    const opponent = battle.participants.find((p: any) => p.user_id !== currentUser.id);\n    const myParticipant = battle.participants.find((p: any) => p.user_id === currentUser.id);\n\n    // Additional state for countdown\n    const [starting, setStarting] = useState(false);\n    const [countdown, setCountdown] = useState(3);\n\n    // Helper functions (defined early to avoid hoisting issues)\n    const handleJoinRematch = async (code: string) => {\n        try {\n            const res = await fetch(\"/api/battle/join\", {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ code })\n            });\n\n            if (!res.ok) {\n                const data = await res.json();\n                toast.error(data.error || \"Failed to join rematch\");\n                return;\n            }\n\n            const data = await res.json();\n            router.push(`/app/practice/battle/${data.battle.id}`);\n        } catch (error) {\n            console.error(\"Error joining rematch:\", error);\n            toast.error(\"Failed to join rematch\");\n        }\n    };\n\n    const fetchBattleData = async () => {\n        const currentBattle = battleRef.current;\n        const currentMyParticipant = currentBattle.participants.find((p: any) => p.user_id === currentUser.id);\n\n        try {\n            const res = await fetch(`/api/battle/${currentBattle.id}`);\n            if (res.ok) {\n                const data = await res.json();\n                if (data.battle) {\n                    // Prevent reverting status from IN_PROGRESS to WAITING due to race condition\n                    if (currentBattle.status === 'IN_PROGRESS' && data.battle.status === 'WAITING') {\n                        data.battle.status = 'IN_PROGRESS';\n                    }\n\n                    // Prevent reverting finished status if we know we are finished\n                    // This fixes the persistent polling issue where stale server data restarts the interval\n                    if (currentMyParticipant?.finished) {\n                        const serverMyPart = data.battle.participants.find((p: any) => p.user_id === currentUser.id);\n                        if (serverMyPart) {\n                            serverMyPart.finished = true;\n                            // Ensure score doesn't revert either\n                            serverMyPart.score = Math.max(serverMyPart.score, currentMyParticipant.score);\n                            serverMyPart.current_q_index = Math.max(serverMyPart.current_q_index, currentMyParticipant.current_q_index);\n                        }\n                    }\n\n                    setBattle(data.battle);\n\n                    // Also update waiting status if changed\n                    if (data.battle.status === 'IN_PROGRESS') setWaiting(false);\n                    if (data.battle.status === 'COMPLETED') {\n                        toast.success(\"Battle Completed!\");\n                        // Redirect to results or show summary\n                    }\n                }\n            }\n        } catch (e) {\n            console.error(\"Failed to fetch battle data:\", e);\n        }\n    };\n\n    // Check for completion moved to bottom to avoid hook errors\n\n    // Realtime subscription\n    useEffect(() => {\n        if (!supabase) {\n            console.warn('[BATTLE-REALTIME] Supabase client not available');\n            return;\n        }\n\n        console.log('[BATTLE-REALTIME] Setting up subscription for battle:', battle.id);\n\n        const channel = supabase.channel(`battle:${battle.id}`)\n            .on('broadcast', { event: 'BATTLE_UPDATE' }, (payload: any) => {\n                console.log('[BATTLE-REALTIME] ✅ Received BATTLE_UPDATE:', payload);\n\n                if (payload.payload?.type === 'BATTLE_CANCELLED') {\n                    toast.error(\"Battle was cancelled by the host\");\n                    router.push('/app/practice/battle');\n                    return;\n                }\n\n                if (payload.payload?.type === 'PARTICIPANT_LEFT') {\n                    if (payload.payload.userId !== currentUser.id) {\n                        toast.info(\"Opponent left the lobby\");\n                        // Refresh data to show waiting state again\n                        fetchBattleData();\n                    }\n                    return;\n                }\n\n                // Optimistic update for faster sync\n                if (payload.payload?.status === 'IN_PROGRESS') {\n                    console.log('[BATTLE-REALTIME] Updating status to IN_PROGRESS');\n                    setBattle((prev: any) => ({ ...prev, status: 'IN_PROGRESS' }));\n                }\n\n                console.log('[BATTLE-REALTIME] Fetching latest battle data...');\n                fetchBattleData();\n            })\n            .on('broadcast', { event: 'REMATCH' }, (payload: any) => {\n                console.log('[BATTLE-REALTIME] ✅ Received REMATCH:', payload);\n                if (payload.payload?.newBattleId) {\n                    // If I am the requester, I'm already redirected by the API response (or should be)\n                    // But if I'm the opponent, I need to join\n                    if (payload.payload.requesterId !== currentUser.id) {\n                        toast.success(\"Opponent wants a rematch!\", {\n                            action: {\n                                label: \"Join\",\n                                onClick: () => handleJoinRematch(payload.payload.newBattleCode)\n                            },\n                            duration: 10000,\n                        });\n                    }\n                }\n            })\n            .subscribe((status: string) => {\n                console.log('[BATTLE-REALTIME] Subscription status:', status);\n                if (status === 'SUBSCRIBED') {\n                    console.log('[BATTLE-REALTIME] Successfully subscribed to channel');\n                    // Signal presence to force refresh for others (e.g. host sees joiner)\n                    channel.send({\n                        type: 'broadcast',\n                        event: 'BATTLE_UPDATE',\n                        payload: { type: 'JOIN' }\n                    });\n                }\n            });\n\n        return () => {\n            console.log('[BATTLE-REALTIME] Cleaning up subscription');\n            supabase.removeChannel(channel);\n        };\n    }, [battle.id, supabase]);\n\n    // Removed polling - now relying entirely on Supabase Realtime broadcasts\n\n    // Timer logic\n    useEffect(() => {\n        if (waiting || starting || battle.status === \"COMPLETED\" || myParticipant?.finished) return;\n\n        if (timeLeft <= 0) {\n            handleAnswer(true); // Auto-submit on timeout\n            return;\n        }\n\n        const timer = setInterval(() => {\n            setTimeLeft((prev: number) => prev - 1);\n        }, 1000);\n\n        return () => clearInterval(timer);\n    }, [timeLeft, waiting, starting, battle.status, myParticipant?.finished]);\n\n    // Start countdown logic\n    useEffect(() => {\n        if (battle.status === \"IN_PROGRESS\" && initialBattle.status === \"WAITING\") {\n            setStarting(true);\n            setWaiting(false);\n            let count = 3;\n            setCountdown(count);\n\n            const interval = setInterval(() => {\n                count--;\n                setCountdown(count);\n                if (count <= 0) {\n                    clearInterval(interval);\n                    setStarting(false);\n                }\n            }, 1000);\n\n            return () => clearInterval(interval);\n        }\n    }, [battle.status]);\n\n    // Handle unmount / navigation away\n    useEffect(() => {\n        const handleUnload = () => {\n            if (isLeavingRef.current) return; // Already handled manually\n\n            const currentBattle = battleRef.current;\n            const myPart = currentBattle.participants.find((p: any) => p.user_id === currentUser.id);\n\n            // Only leave if battle is active AND I haven't finished\n            const isActive = currentBattle.status === 'WAITING' || currentBattle.status === 'IN_PROGRESS';\n            const isNotFinished = !myPart?.finished && currentBattle.status !== 'COMPLETED';\n\n            if (isActive && isNotFinished) {\n                // Use fetch with keepalive to ensure request sends during unload\n                fetch(\"/api/battle/leave\", {\n                    method: \"POST\",\n                    headers: { \"Content-Type\": \"application/json\" },\n                    body: JSON.stringify({ battleId: currentBattle.id }),\n                    keepalive: true\n                });\n            }\n        };\n\n        // Handle tab close / refresh\n        window.addEventListener('beforeunload', handleUnload);\n\n        return () => {\n            window.removeEventListener('beforeunload', handleUnload);\n            // Do NOT call handleUnload() here during cleanup to prevent accidental leave in Strict Mode\n            // Users must explicitly click \"Leave\" or close the tab (handled by beforeunload)\n        };\n    }, [currentUser.id]);\n\n    // Check for completion - AFTER all hooks to avoid \"Rendered fewer hooks than expected\" error\n    if (myParticipant?.finished || battle.status === \"COMPLETED\") {\n        return <BattleResult battle={battle} currentUser={currentUser} />;\n    }\n\n    const handleStart = async () => {\n        try {\n            const res = await fetch(\"/api/battle/start\", {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ battleId: battle.id })\n            });\n\n            if (!res.ok) {\n                const data = await res.json();\n                throw new Error(data.error || \"Failed to start battle\");\n            }\n\n            // Optimistic update\n            setBattle((prev: any) => ({ ...prev, status: \"IN_PROGRESS\" }));\n\n            // Signal start to everyone\n            if (supabase) {\n                const channel = supabase.channel(`battle:${battle.id}`);\n                await channel.send({\n                    type: 'broadcast',\n                    event: 'BATTLE_UPDATE',\n                    payload: { type: 'START' }\n                });\n            }\n        } catch (e: any) {\n            toast.error(e.message || \"Failed to start battle\");\n        }\n    };\n\n    const handleLeave = async () => {\n        isLeavingRef.current = true; // Mark as intentionally leaving\n        try {\n            const res = await fetch(\"/api/battle/leave\", {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ battleId: battle.id })\n            });\n\n            if (res.ok) {\n                router.push('/app/practice/battle');\n                toast.success(\"Left lobby\");\n            } else {\n                toast.error(\"Failed to leave lobby\");\n            }\n        } catch (e) {\n            console.error(\"Error leaving lobby:\", e);\n            toast.error(\"Failed to leave lobby\");\n        }\n    };\n\n    const handleAnswer = async (autoSubmit: boolean | any = false) => {\n        // If called from button click, autoSubmit will be the event object, so treat as false\n        const isAuto = typeof autoSubmit === 'boolean' ? autoSubmit : false;\n\n        if (submitting) return;\n        setSubmitting(true);\n\n        const question = battle.quiz.questions[currentQIndex];\n\n        console.log('[BATTLE-ANSWER] ========== Answer Validation ==========');\n        console.log('[BATTLE-ANSWER] Question:', question.question_text);\n        console.log('[BATTLE-ANSWER] Question Type:', question.question_type);\n        console.log('[BATTLE-ANSWER] Selected Answer:', selectedAnswer, 'Type:', typeof selectedAnswer);\n        console.log('[BATTLE-ANSWER] Correct Answer:', question.correct_answer, 'Type:', typeof question.correct_answer);\n        console.log('[BATTLE-ANSWER] Options:', question.options);\n        console.log('[BATTLE-ANSWER] Is Auto-submit:', isAuto);\n\n        // Validation logic - only if not auto-submit (timeout)\n        let isCorrect = false;\n\n        if (!isAuto && selectedAnswer !== null) {\n            if (question.question_type === \"MCQ\" || question.question_type === \"TRUE_FALSE\") {\n                // For MCQ/TF, compare exact match\n                const selectedLower = String(selectedAnswer).toLowerCase().trim();\n                const correctLower = String(question.correct_answer).toLowerCase().trim();\n\n                console.log('[BATTLE-ANSWER] Comparing (lowercase, trimmed):');\n                console.log('[BATTLE-ANSWER]   Selected:', `\"${selectedLower}\"`);\n                console.log('[BATTLE-ANSWER]   Correct:', `\"${correctLower}\"`);\n\n                isCorrect = selectedLower === correctLower;\n                console.log('[BATTLE-ANSWER] String match result:', isCorrect);\n\n                // Fallback: if correct_answer is an index (0, 1, 2...)\n                if (!isCorrect && typeof question.correct_answer === 'number') {\n                    const options = question.options as string[];\n                    if (options && options[question.correct_answer] === selectedAnswer) {\n                        isCorrect = true;\n                        console.log('[BATTLE-ANSWER] Index match result: true');\n                    }\n                }\n            } else {\n                // For text answers, simple case-insensitive match\n                isCorrect = String(selectedAnswer).toLowerCase().trim() === String(question.correct_answer).toLowerCase().trim();\n            }\n        }\n\n        console.log('[BATTLE-ANSWER] Final isCorrect:', isCorrect);\n        console.log('[BATTLE-ANSWER] =====================================\\n');\n\n        // No points on timeout or no answer\n        const points = isCorrect ? question.points : 0;\n        const newScore = (myParticipant?.score || 0) + points;\n\n        const finished = currentQIndex >= battle.quiz.questions.length - 1;\n\n        try {\n            await fetch(\"/api/battle/update-progress\", {\n                method: \"POST\",\n                body: JSON.stringify({\n                    battleId: battle.id,\n                    score: newScore,\n                    questionIndex: currentQIndex + 1,\n                    finished\n                })\n            });\n\n            // Signal progress update\n            if (supabase) {\n                const channel = supabase.channel(`battle:${battle.id}`);\n                await channel.send({\n                    type: 'broadcast',\n                    event: 'BATTLE_UPDATE',\n                    payload: { type: 'PROGRESS', userId: currentUser.id }\n                });\n            }\n\n            if (isCorrect) {\n                toast.success(`Correct! +${points} pts`);\n            } else if (isAuto) {\n                toast.error(\"Time's up! No points\");\n            } else if (!isAuto) {\n                toast.error(\"Incorrect!\");\n            }\n\n            if (finished) {\n                toast.success(\"You finished!\");\n                // Force local update to show results immediately\n                setBattle((prev: any) => ({\n                    ...prev,\n                    participants: prev.participants.map((p: any) =>\n                        p.user_id === currentUser.id\n                            ? { ...p, score: newScore, finished: true }\n                            : p\n                    )\n                }));\n            } else {\n                setCurrentQIndex((prev: number) => prev + 1);\n                setSelectedAnswer(null);\n                setTimeLeft(15);\n            }\n        } catch (e) {\n            toast.error(\"Failed to submit answer\");\n        } finally {\n            setSubmitting(false);\n        }\n    };\n\n    const copyCode = () => {\n        navigator.clipboard.writeText(battle.code);\n        toast.success(\"Code copied!\");\n    };\n\n    if (starting) {\n        return (\n            <div className=\"min-h-screen flex items-center justify-center bg-slate-950 text-white relative overflow-hidden\">\n                <div className=\"fixed inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-indigo-900/40 via-slate-950 to-slate-950 pointer-events-none\" />\n                <div className=\"z-10 flex flex-col items-center animate-in zoom-in duration-500\">\n                    <h2 className=\"text-4xl font-bold text-indigo-400 mb-4\">Get Ready!</h2>\n                    <div className=\"text-9xl font-black bg-gradient-to-b from-white to-slate-500 bg-clip-text text-transparent drop-shadow-[0_0_30px_rgba(99,102,241,0.5)]\">\n                        {countdown}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    if (waiting) {\n        return (\n            <div className=\"min-h-screen flex flex-col items-center justify-start pt-20 md:justify-center md:pt-0 p-4 bg-slate-950 text-slate-100 font-sans selection:bg-purple-500/30 relative overflow-hidden\">\n                {/* Background Effects */}\n\n                {/* Animated Grid Background */}\n                <div className=\"absolute inset-0 bg-[url('/grid.svg')] bg-center [mask-image:linear-gradient(180deg,white,rgba(255,255,255,0))] opacity-20 pointer-events-none\" />\n\n                <div className=\"bg-slate-900/50 backdrop-blur-xl p-4 md:p-8 rounded-3xl max-w-md w-full text-center space-y-4 md:space-y-8 border border-slate-800 shadow-2xl relative z-10 animate-in fade-in zoom-in-95 duration-500\">\n                    <div className=\"space-y-1 md:space-y-2 relative\">\n                        {/* Leave Button */}\n                        <div className=\"absolute left-0 top-0\">\n                            <Button\n                                variant=\"ghost\"\n                                size=\"icon\"\n                                onClick={handleLeave}\n                                className=\"text-slate-400 hover:text-red-400 hover:bg-red-500/10\"\n                                title=\"Leave Lobby\"\n                            >\n                                <LogOut className=\"h-5 w-5\" />\n                            </Button>\n                        </div>\n\n                        <h2 className=\"text-2xl md:text-4xl font-black tracking-tight bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent\">\n                            BATTLE LOBBY\n                        </h2>\n                        <p className=\"text-sm md:text-base text-slate-400\">Waiting for players to join...</p>\n                    </div>\n\n                    <div className=\"py-4 md:py-8 relative\">\n                        <div className=\"absolute inset-0 bg-indigo-500/5 blur-3xl rounded-full\" />\n                        <p className=\"text-[10px] md:text-xs font-bold text-indigo-400 uppercase tracking-widest mb-2 md:mb-4\">Join Code</p>\n                        <div className=\"flex items-center justify-center gap-3 md:gap-4\">\n                            <span className=\"text-4xl md:text-6xl font-mono font-bold tracking-widest text-white drop-shadow-[0_0_15px_rgba(99,102,241,0.5)]\">\n                                {battle.code}\n                            </span>\n                            <Button\n                                size=\"icon\"\n                                variant=\"outline\"\n                                onClick={copyCode}\n                                className=\"h-10 w-10 md:h-12 md:w-12 rounded-xl border-slate-700 bg-slate-800/50 hover:bg-slate-700 hover:text-white transition-all\"\n                            >\n                                <Copy className=\"h-4 w-4 md:h-5 md:w-5\" />\n                            </Button>\n                        </div>\n                    </div>\n\n                    <div className=\"space-y-3 md:space-y-4\">\n                        <div className=\"flex items-center justify-between bg-slate-800/50 p-3 md:p-4 rounded-2xl border border-slate-700/50\">\n                            <div className=\"flex items-center gap-3 md:gap-4\">\n                                <div className=\"h-10 w-10 md:h-12 md:w-12 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center font-bold text-white shadow-lg text-sm md:text-base\">\n                                    {currentUser.username?.[0]?.toUpperCase()}\n                                </div>\n                                <div className=\"flex flex-col items-start\">\n                                    <span className=\"font-bold text-white text-sm md:text-base\">{currentUser.username}</span>\n                                    <span className=\"text-[10px] md:text-xs text-indigo-300\">You</span>\n                                </div>\n                            </div>\n                            <span className=\"px-2 py-0.5 md:px-3 md:py-1 rounded-full bg-emerald-500/10 text-emerald-400 text-[10px] md:text-xs font-bold border border-emerald-500/20\">\n                                READY\n                            </span>\n                        </div>\n\n                        {opponent ? (\n                            <div className=\"flex items-center justify-between bg-slate-800/50 p-3 md:p-4 rounded-2xl border border-slate-700/50 animate-in slide-in-from-bottom-4 fade-in duration-300\">\n                                <div className=\"flex items-center gap-3 md:gap-4\">\n                                    <div className=\"h-10 w-10 md:h-12 md:w-12 rounded-full bg-gradient-to-br from-rose-500 to-orange-600 flex items-center justify-center font-bold text-white shadow-lg text-sm md:text-base\">\n                                        {opponent.user?.username?.[0]?.toUpperCase() || \"?\"}\n                                    </div>\n                                    <div className=\"flex flex-col items-start\">\n                                        <span className=\"font-bold text-white text-sm md:text-base\">{opponent.user?.username || \"Opponent\"}</span>\n                                        <span className=\"text-[10px] md:text-xs text-rose-300\">Challenger</span>\n                                    </div>\n                                </div>\n                                <span className=\"px-2 py-0.5 md:px-3 md:py-1 rounded-full bg-emerald-500/10 text-emerald-400 text-[10px] md:text-xs font-bold border border-emerald-500/20\">\n                                    READY\n                                </span>\n                            </div>\n                        ) : (\n                            <div className=\"flex flex-col items-center justify-center p-6 md:p-8 border-2 border-dashed border-slate-800 rounded-2xl text-slate-500 gap-2 md:gap-3 animate-pulse bg-slate-900/30\">\n                                <Loader2 className=\"h-6 w-6 md:h-8 md:w-8 animate-spin text-indigo-500/50\" />\n                                <span className=\"text-xs md:text-sm font-medium\">Waiting for opponent...</span>\n                            </div>\n                        )}\n                    </div>\n\n                    {battle.created_by === currentUser.id && (\n                        <Button\n                            className=\"w-full h-16 text-xl font-bold bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-400 hover:to-teal-400 shadow-lg shadow-emerald-500/20 transition-all hover:scale-[1.02] active:scale-[0.98] rounded-xl\"\n                            disabled={!opponent}\n                            onClick={handleStart}\n                        >\n                            {opponent ? (\n                                <span className=\"flex items-center gap-2\">\n                                    <Swords className=\"h-6 w-6\" />\n                                    START BATTLE\n                                </span>\n                            ) : (\n                                \"Waiting for Player...\"\n                            )}\n                        </Button>\n                    )}\n\n                    {battle.created_by !== currentUser.id && (\n                        <div className=\"p-4 rounded-xl bg-slate-800/50 border border-slate-700 text-slate-400 text-sm animate-pulse flex items-center justify-center gap-2\">\n                            <Loader2 className=\"h-4 w-4 animate-spin\" />\n                            Waiting for host to start...\n                        </div>\n                    )}\n                </div>\n            </div>\n        );\n    }\n\n    // Battle Interface\n    const question = battle.quiz.questions[currentQIndex];\n    if (!question) return <div>Battle Finished!</div>;\n\n    return (\n        <div className=\"min-h-screen bg-slate-950 text-slate-100 p-2 md:p-4 font-sans selection:bg-purple-500/30\">\n            {/* Background Effects */}\n            <div className=\"fixed inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-indigo-900/40 via-slate-950 to-slate-950 pointer-events-none\" />\n\n            <div className=\"max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-4 md:gap-8 relative z-10 pt-2 md:pt-8\">\n\n                {/* Header / Timer Bar */}\n                <div className=\"lg:col-span-12 flex items-center justify-between bg-slate-900/50 backdrop-blur-md border border-slate-800 p-3 md:p-4 rounded-2xl shadow-xl\">\n                    <div className=\"flex items-center gap-3 md:gap-4\">\n                        <div className=\"h-8 w-8 md:h-10 md:w-10 rounded-xl bg-indigo-500/20 flex items-center justify-center text-indigo-400\">\n                            <Clock className=\"h-5 w-5 md:h-6 md:w-6\" />\n                        </div>\n                        <div className=\"flex flex-col\">\n                            <span className=\"text-[10px] md:text-xs text-slate-400 font-medium uppercase tracking-wider\">Time</span>\n                            <span className={`text-xl md:text-2xl font-bold font-mono ${timeLeft <= 5 ? 'text-red-400 animate-pulse' : 'text-white'}`}>\n                                {timeLeft}s\n                            </span>\n                        </div>\n                    </div>\n\n                    <div className=\"flex flex-col items-end\">\n                        <span className=\"text-[10px] md:text-xs text-slate-400 font-medium uppercase tracking-wider\">Round</span>\n                        <div className=\"flex items-center gap-1\">\n                            <span className=\"text-xl md:text-2xl font-bold text-white\">{currentQIndex + 1}</span>\n                            <span className=\"text-base md:text-lg text-slate-500\">/</span>\n                            <span className=\"text-base md:text-lg text-slate-500\">{battle.quiz.questions.length}</span>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Mobile Live Points Bar (Top) */}\n                <div className=\"lg:hidden flex items-center justify-between gap-2 bg-slate-900/50 backdrop-blur-md border border-slate-800 p-2 rounded-xl\">\n                    {/* My Score Compact */}\n                    <div className=\"flex items-center gap-2 flex-1 bg-indigo-500/10 rounded-lg p-2 border border-indigo-500/20\">\n                        <div className=\"h-6 w-6 rounded-full bg-indigo-500 flex items-center justify-center font-bold text-white text-[10px]\">\n                            YOU\n                        </div>\n                        <div className=\"flex flex-col\">\n                            <span className=\"text-xs font-bold text-white leading-none\">{myParticipant?.score || 0}</span>\n                            <Progress\n                                value={((myParticipant?.current_q_index || 0) / battle.quiz.questions.length) * 100}\n                                className=\"h-1 w-12 bg-slate-800 mt-1\"\n                                indicatorClassName=\"bg-indigo-500\"\n                            />\n                        </div>\n                    </div>\n\n                    {/* Opponent Score Compact */}\n                    <div className=\"flex items-center gap-2 flex-1 justify-end bg-slate-800/30 rounded-lg p-2 border border-slate-700/50\">\n                        <div className=\"flex flex-col items-end\">\n                            <span className=\"text-xs font-bold text-slate-200 leading-none\">{opponent?.score || 0}</span>\n                            <Progress\n                                value={((opponent?.current_q_index || 0) / battle.quiz.questions.length) * 100}\n                                className=\"h-1 w-12 bg-slate-800 mt-1\"\n                                indicatorClassName=\"bg-rose-500\"\n                            />\n                        </div>\n                        <div className=\"h-6 w-6 rounded-full bg-rose-500 flex items-center justify-center font-bold text-white text-[10px]\">\n                            OPP\n                        </div>\n                    </div>\n                </div>\n\n                {/* Main Quiz Area */}\n                <div className=\"lg:col-span-8 space-y-4 md:space-y-6\">\n                    <QuestionCard\n                        questionType={question.question_type}\n                        questionNumber={currentQIndex + 1}\n                        totalQuestions={battle.quiz.questions.length}\n                        points={question.points}\n                        className=\"bg-slate-900/80 border-slate-800 shadow-2xl backdrop-blur-sm dark\" // Force dark mode\n                    >\n                        <div className=\"space-y-4 md:space-y-8 py-2\">\n                            <p className=\"text-lg md:text-2xl font-medium leading-relaxed text-slate-100\">\n                                {question.question_text}\n                            </p>\n\n                            <div className=\"grid gap-3 md:gap-4\">\n                                {question.options?.map((opt: string, idx: number) => (\n                                    <button\n                                        key={idx}\n                                        onClick={() => setSelectedAnswer(opt)}\n                                        className={`\n                                            group relative w-full p-3 md:p-5 text-left rounded-xl border-2 transition-all duration-200\n                                            hover:scale-[1.01] active:scale-[0.99]\n                                            ${selectedAnswer === opt\n                                                ? \"bg-indigo-600/20 border-indigo-500 shadow-[0_0_20px_rgba(99,102,241,0.3)]\"\n                                                : \"bg-slate-800/50 border-slate-700 hover:bg-slate-800 hover:border-slate-600\"\n                                            }\n                                        `}\n                                    >\n                                        <div className=\"flex items-center gap-3 md:gap-4\">\n                                            <div className={`\n                                                h-6 w-6 md:h-8 md:w-8 rounded-lg flex items-center justify-center text-xs md:text-sm font-bold border transition-colors\n                                                ${selectedAnswer === opt\n                                                    ? \"bg-indigo-500 border-indigo-400 text-white\"\n                                                    : \"bg-slate-700 border-slate-600 text-slate-400 group-hover:border-slate-500\"\n                                                }\n                                            `}>\n                                                {String.fromCharCode(65 + idx)}\n                                            </div>\n                                            <span className={`text-sm md:text-lg ${selectedAnswer === opt ? \"text-white font-medium\" : \"text-slate-300\"}`}>\n                                                {opt}\n                                            </span>\n                                        </div>\n                                    </button>\n                                ))}\n                            </div>\n                        </div>\n                    </QuestionCard>\n\n                    <Button\n                        className=\"w-full h-12 md:h-14 text-base md:text-lg font-bold bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 shadow-lg shadow-indigo-500/25 transition-all hover:scale-[1.02] active:scale-[0.98]\"\n                        onClick={() => handleAnswer(false)}\n                        disabled={!selectedAnswer || submitting}\n                    >\n                        {submitting ? (\n                            <>\n                                <Loader2 className=\"mr-2 h-4 w-4 md:h-5 md:w-5 animate-spin\" />\n                                Locking in...\n                            </>\n                        ) : (\n                            \"Submit Answer\"\n                        )}\n                    </Button>\n                </div>\n\n                {/* Desktop Sidebar / Opponent Status */}\n                <div className=\"hidden lg:block lg:col-span-4 space-y-6\">\n                    <div className=\"bg-slate-900/50 backdrop-blur-md border border-slate-800 p-6 rounded-2xl shadow-xl space-y-6 sticky top-8\">\n                        <h3 className=\"font-bold text-lg flex items-center gap-2 text-white\">\n                            <Trophy className=\"h-5 w-5 text-yellow-500\" />\n                            Live Standings\n                        </h3>\n\n                        <div className=\"space-y-6\">\n                            {/* My Score */}\n                            <div className=\"space-y-3 p-4 bg-indigo-500/10 rounded-xl border border-indigo-500/20\">\n                                <div className=\"flex justify-between items-center\">\n                                    <div className=\"flex items-center gap-3\">\n                                        <div className=\"h-8 w-8 rounded-full bg-indigo-500 flex items-center justify-center font-bold text-white text-xs\">\n                                            YOU\n                                        </div>\n                                        <span className=\"font-medium text-indigo-200\">You</span>\n                                    </div>\n                                    <span className=\"font-bold text-2xl text-white\">{myParticipant?.score || 0}</span>\n                                </div>\n                                <div className=\"space-y-1\">\n                                    <div className=\"flex justify-between text-xs text-indigo-300/70\">\n                                        <span>Progress</span>\n                                        <span>{Math.round(((myParticipant?.current_q_index || 0) / battle.quiz.questions.length) * 100)}%</span>\n                                    </div>\n                                    <Progress\n                                        value={((myParticipant?.current_q_index || 0) / battle.quiz.questions.length) * 100}\n                                        className=\"h-2 bg-slate-800\"\n                                        indicatorClassName=\"bg-gradient-to-r from-indigo-500 to-purple-500\"\n                                    />\n                                </div>\n                            </div>\n\n                            {/* Opponent Score */}\n                            <div className=\"space-y-3 p-4 bg-slate-800/30 rounded-xl border border-slate-700/50\">\n                                <div className=\"flex justify-between items-center\">\n                                    <div className=\"flex items-center gap-3\">\n                                        <div className=\"h-8 w-8 rounded-full bg-rose-500 flex items-center justify-center font-bold text-white text-xs\">\n                                            OPP\n                                        </div>\n                                        <span className=\"font-medium text-slate-300\">{opponent?.user?.username || \"Opponent\"}</span>\n                                    </div>\n                                    <span className=\"font-bold text-2xl text-slate-200\">{opponent?.score || 0}</span>\n                                </div>\n                                <div className=\"space-y-1\">\n                                    <div className=\"flex justify-between text-xs text-slate-500\">\n                                        <span>Progress</span>\n                                        <span>{Math.round(((opponent?.current_q_index || 0) / battle.quiz.questions.length) * 100)}%</span>\n                                    </div>\n                                    <Progress\n                                        value={((opponent?.current_q_index || 0) / battle.quiz.questions.length) * 100}\n                                        className=\"h-2 bg-slate-800\"\n                                        indicatorClassName=\"bg-rose-500\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n","\"use client\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Trophy, Home, Swords, Loader2, Frown, Medal } from \"lucide-react\";\nimport Link from \"next/link\";\nimport { motion } from \"framer-motion\";\nimport { useState } from \"react\";\nimport { toast } from \"sonner\";\nimport { useRouter } from \"next/navigation\";\n\ninterface BattleResultProps {\n    battle: any;\n    currentUser: any;\n}\n\nexport function BattleResult({ battle, currentUser }: BattleResultProps) {\n    const router = useRouter();\n    const [rematchLoading, setRematchLoading] = useState(false);\n    const myParticipant = battle.participants.find((p: any) => p.user_id === currentUser.id);\n    const opponent = battle.participants.find((p: any) => p.user_id !== currentUser.id);\n\n    const iWon = myParticipant?.score > (opponent?.score || 0);\n    const isDraw = myParticipant?.score === (opponent?.score || 0);\n    const opponentFinished = opponent?.finished;\n    const battleCompleted = battle.status === \"COMPLETED\";\n\n    const handleRematch = async () => {\n        setRematchLoading(true);\n        try {\n            const res = await fetch(\"/api/battle/rematch\", {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ battleId: battle.id })\n            });\n\n            const data = await res.json();\n            if (!res.ok) throw new Error(data.error);\n\n            toast.success(\"Rematch created! Redirecting...\");\n\n            // Redirect to new battle\n            router.push(`/app/practice/battle/${data.battleId}`);\n        } catch (error: any) {\n            toast.error(error.message || \"Failed to create rematch\");\n        } finally {\n            setRematchLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"min-h-screen bg-slate-950 text-slate-100 font-sans selection:bg-purple-500/30 relative overflow-hidden flex items-center justify-center p-4\">\n            {/* Background Effects */}\n            <div className=\"fixed inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-indigo-900/40 via-slate-950 to-slate-950 pointer-events-none\" />\n            <div className=\"absolute inset-0 bg-[url('/grid.svg')] bg-center [mask-image:linear-gradient(180deg,white,rgba(255,255,255,0))] opacity-20 pointer-events-none\" />\n\n            <div className=\"max-w-2xl w-full space-y-8 relative z-10\">\n                <div className=\"text-center space-y-2 animate-in slide-in-from-bottom-4 fade-in duration-700\">\n                    <h1 className=\"text-5xl md:text-7xl font-black tracking-tight bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 bg-clip-text text-transparent drop-shadow-sm\">\n                        {battleCompleted ? (iWon ? \"VICTORY!\" : isDraw ? \"DRAW!\" : \"DEFEAT\") : \"FINISHED!\"}\n                    </h1>\n                    <p className=\"text-xl text-slate-400\">\n                        {battleCompleted\n                            ? \"The battle has ended. Here are the results.\"\n                            : \"You have completed the quiz. Waiting for opponent...\"}\n                    </p>\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    {/* My Card */}\n                    <div className={`relative overflow-hidden rounded-3xl p-6 border-2 ${iWon && battleCompleted ? 'border-yellow-500 bg-yellow-500/10' : 'border-slate-800 bg-slate-900/50'} backdrop-blur-xl transition-all duration-500`}>\n                        <div className=\"flex flex-col items-center space-y-4\">\n                            <div className=\"relative\">\n                                <div className={`h-24 w-24 rounded-full flex items-center justify-center text-3xl font-bold text-white shadow-xl ${iWon && battleCompleted ? 'bg-gradient-to-br from-yellow-400 to-orange-500' : 'bg-gradient-to-br from-indigo-500 to-purple-600'}`}>\n                                    {currentUser.username?.[0]?.toUpperCase()}\n                                </div>\n                                {iWon && battleCompleted && (\n                                    <div className=\"absolute -top-2 -right-2 bg-yellow-400 text-yellow-900 p-2 rounded-full shadow-lg animate-bounce\">\n                                        <Trophy className=\"h-6 w-6\" />\n                                    </div>\n                                )}\n                            </div>\n                            <div className=\"text-center\">\n                                <h3 className=\"text-2xl font-bold text-white\">{currentUser.username}</h3>\n                                <p className=\"text-indigo-300 font-medium\">You</p>\n                            </div>\n                            <div className=\"w-full py-4 border-t border-slate-700/50\">\n                                <div className=\"flex justify-between items-end\">\n                                    <span className=\"text-slate-400 text-sm uppercase tracking-wider font-bold\">Score</span>\n                                    <span className=\"text-4xl font-black text-white\">{myParticipant?.score || 0}</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Opponent Card */}\n                    <div className={`relative overflow-hidden rounded-3xl p-6 border-2 ${!iWon && !isDraw && battleCompleted ? 'border-yellow-500 bg-yellow-500/10' : 'border-slate-800 bg-slate-900/50'} backdrop-blur-xl transition-all duration-500`}>\n                        <div className=\"flex flex-col items-center space-y-4\">\n                            <div className=\"relative\">\n                                <div className={`h-24 w-24 rounded-full flex items-center justify-center text-3xl font-bold text-white shadow-xl ${!iWon && !isDraw && battleCompleted ? 'bg-gradient-to-br from-yellow-400 to-orange-500' : 'bg-gradient-to-br from-rose-500 to-orange-600'}`}>\n                                    {opponent?.user?.username?.[0]?.toUpperCase() || \"?\"}\n                                </div>\n                                {!iWon && !isDraw && battleCompleted && (\n                                    <div className=\"absolute -top-2 -right-2 bg-yellow-400 text-yellow-900 p-2 rounded-full shadow-lg animate-bounce\">\n                                        <Trophy className=\"h-6 w-6\" />\n                                    </div>\n                                )}\n                            </div>\n                            <div className=\"text-center\">\n                                <h3 className=\"text-2xl font-bold text-white\">{opponent?.user?.username || \"Opponent\"}</h3>\n                                <p className=\"text-rose-300 font-medium\">Challenger</p>\n                            </div>\n                            <div className=\"w-full py-4 border-t border-slate-700/50\">\n                                <div className=\"flex justify-between items-end\">\n                                    <span className=\"text-slate-400 text-sm uppercase tracking-wider font-bold\">Score</span>\n                                    <span className=\"text-4xl font-black text-white\">{opponent?.score || 0}</span>\n                                </div>\n                            </div>\n                            {!battleCompleted && (\n                                <div className=\"absolute inset-0 bg-slate-950/60 backdrop-blur-sm flex items-center justify-center\">\n                                    <div className=\"flex flex-col items-center gap-2 text-slate-300 animate-pulse\">\n                                        <Loader2 className=\"h-8 w-8 animate-spin\" />\n                                        <span className=\"font-bold\">Still playing...</span>\n                                    </div>\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n\n                <div className=\"flex justify-center gap-4 pt-8\">\n                    <Link href=\"/app/practice/battle\">\n                        <Button className=\"h-14 px-8 text-lg font-bold bg-slate-800 hover:bg-slate-700 text-white border border-slate-700 rounded-xl shadow-lg transition-all hover:scale-105\">\n                            <Home className=\"mr-2 h-5 w-5\" />\n                            Lobby\n                        </Button>\n                    </Link>\n                    <Button\n                        onClick={handleRematch}\n                        disabled={rematchLoading}\n                        className=\"h-14 px-8 text-lg font-bold bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white rounded-xl shadow-lg shadow-indigo-500/25 transition-all hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                        {rematchLoading ? (\n                            <>\n                                <Loader2 className=\"mr-2 h-5 w-5 animate-spin\" />\n                                Creating...\n                            </>\n                        ) : (\n                            <>\n                                <Swords className=\"mr-2 h-5 w-5\" />\n                                Rematch\n                            </>\n                        )}\n                    </Button>\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}