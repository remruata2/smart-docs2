module.exports=[145706,(a,b,c)=>{b.exports=a.x("querystring",()=>require("querystring"))},575096,a=>{a.v({name:"openid-client",version:"5.7.1",description:"OpenID Connect Relying Party (RP, Client) implementation for Node.js runtime, supports passportjs",keywords:["auth","authentication","basic","certified","client","connect","dynamic","electron","hybrid","identity","implicit","oauth","oauth2","oidc","openid","passport","relying party","strategy"],homepage:"https://github.com/panva/openid-client",repository:"panva/openid-client",funding:{url:"https://github.com/sponsors/panva"},license:"MIT",author:"Filip Skokan <panva.ip@gmail.com>",exports:{types:"./types/index.d.ts",import:"./lib/index.mjs",require:"./lib/index.js"},main:"./lib/index.js",types:"./types/index.d.ts",files:["lib","types/index.d.ts"],scripts:{format:"npx prettier --loglevel silent --write ./lib ./test ./certification ./types",test:"mocha test/**/*.test.js"},dependencies:{jose:"^4.15.9","lru-cache":"^6.0.0","object-hash":"^2.2.0","oidc-token-hash":"^5.0.3"},devDependencies:{"@types/node":"^16.18.106","@types/passport":"^1.0.16",base64url:"^3.0.1",chai:"^4.5.0",mocha:"^10.7.3",nock:"^13.5.5",prettier:"^2.8.8","readable-mock-req":"^0.2.2",sinon:"^9.2.4",timekeeper:"^2.3.1"},"standard-version":{scripts:{postchangelog:"sed -i '' -e 's/### \\[/## [/g' CHANGELOG.md"},types:[{type:"feat",section:"Features"},{type:"fix",section:"Fixes"},{type:"chore",hidden:!0},{type:"docs",hidden:!0},{type:"style",hidden:!0},{type:"refactor",section:"Refactor",hidden:!1},{type:"perf",section:"Performance",hidden:!1},{type:"test",hidden:!0}]}})},500874,(a,b,c)=>{b.exports=a.x("buffer",()=>require("buffer"))},449719,(a,b,c)=>{b.exports=a.x("assert",()=>require("assert"))},792509,(a,b,c)=>{b.exports=a.x("url",()=>require("url"))},406461,(a,b,c)=>{b.exports=a.x("zlib",()=>require("zlib"))},427699,(a,b,c)=>{b.exports=a.x("events",()=>require("events"))},522734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},750227,(a,b,c)=>{b.exports=a.x("node:path",()=>require("node:path"))},59639,(a,b,c)=>{b.exports=a.x("node:process",()=>require("node:process"))},660526,(a,b,c)=>{b.exports=a.x("node:os",()=>require("node:os"))},509656,(a,b,c)=>{b.exports=a.x("node:tty",()=>require("node:tty"))},902157,(a,b,c)=>{b.exports=a.x("node:fs",()=>require("node:fs"))},666680,(a,b,c)=>{b.exports=a.x("node:crypto",()=>require("node:crypto"))},874533,(a,b,c)=>{b.exports=a.x("node:child_process",()=>require("node:child_process"))},912714,(a,b,c)=>{b.exports=a.x("node:fs/promises",()=>require("node:fs/promises"))},812057,(a,b,c)=>{b.exports=a.x("node:util",()=>require("node:util"))},478500,(a,b,c)=>{b.exports=a.x("node:async_hooks",()=>require("node:async_hooks"))},687769,(a,b,c)=>{b.exports=a.x("node:events",()=>require("node:events"))},254799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},921517,(a,b,c)=>{b.exports=a.x("http",()=>require("http"))},524836,(a,b,c)=>{b.exports=a.x("https",()=>require("https"))},761469,a=>{"use strict";var b=a.i(107341);let c=global.prisma||new b.PrismaClient;a.s(["db",0,c])},563681,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={RequestCookies:function(){return f.RequestCookies},ResponseCookies:function(){return f.ResponseCookies},stringifyCookie:function(){return f.stringifyCookie}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(536226)},137936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(211857)},713095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},384265,a=>{"use strict";var b=a.i(761469),c=a.i(872849);async function d(){console.log("[USER-SERVICE] Fetching all users...");try{let a=await b.db.user.findMany({select:{id:!0,username:!0,role:!0,is_active:!0,last_login:!0,created_at:!0},orderBy:{created_at:"desc"}});return console.log(`[USER-SERVICE] Found ${a.length} users:`,a),a}catch(a){throw console.error("[USER-SERVICE] Error fetching users:",a),a}}async function e(a){return await b.db.user.findUnique({where:{id:a},select:{id:!0,username:!0,role:!0,is_active:!0,last_login:!0,created_at:!0}})}async function f(a){let{username:d,password:e,role:f,is_active:g=!0}=a,h=await (0,c.hash)(e,10);return await b.db.user.create({data:{username:d,password_hash:h,role:f,is_active:g},select:{id:!0,username:!0,role:!0,is_active:!0,created_at:!0}})}async function g(a,d){let{username:e,password:f,role:g,is_active:h}=d,i={};return void 0!==e&&(i.username=e),void 0!==f&&(i.password_hash=await (0,c.hash)(f,10)),void 0!==g&&(i.role=g),void 0!==h&&(i.is_active=h),await b.db.user.update({where:{id:a},data:i,select:{id:!0,username:!0,role:!0,is_active:!0,last_login:!0,created_at:!0}})}async function h(a){return await b.db.user.delete({where:{id:a}})}a.s(["createUser",()=>f,"deleteUser",()=>h,"getAllUsers",()=>d,"getUserById",()=>e,"updateUser",()=>g])},466830,a=>{"use strict";var b=a.i(137936),c=a.i(384265),d=a.i(591727),e=a.i(794431),f=a.i(547256),g=a.i(107341);async function h(a){let b=await (0,e.getServerSession)(f.authOptions);if(!b||!b.user||b.user.role!==g.UserRole.admin)return{success:!1,error:"Unauthorized"};if(parseInt(b.user.id,10)===a)return{success:!1,error:"You cannot delete your own account."};try{return await (0,c.deleteUser)(a),(0,d.revalidatePath)("/admin/users"),{success:!0}}catch(a){return console.error("Failed to delete user:",a),{success:!1,error:"Failed to delete user. Please try again."}}}async function i(a){let b=await (0,e.getServerSession)(f.authOptions);if(!b||!b.user||b.user.role!==g.UserRole.admin)return{success:!1,error:"Unauthorized"};let{username:h,password:i,role:j,is_active:k}=a;if(!h||!i)return{success:!1,error:"Username and password are required."};try{let a=await (0,c.createUser)({username:h,password:i,role:j,is_active:k});return(0,d.revalidatePath)("/admin/users"),{success:!0,userId:a.id}}catch(a){if(console.error("Failed to create user:",a),"P2002"===a.code&&a.meta?.target?.includes("username"))return{success:!1,error:"Username already exists. Please choose a different username."};return{success:!1,error:a.message||"Failed to create user. Please try again."}}}async function j(a,b){let h=await (0,e.getServerSession)(f.authOptions);if(!h||!h.user||h.user.role!==g.UserRole.admin)return{success:!1,error:"Unauthorized"};let{username:i,password:j,role:k,is_active:l}=b;if(!i)return{success:!1,error:"Username is required."};let m={username:i,role:k,is_active:l};j&&""!==j.trim()&&(m.password=j);try{let b=await (0,c.updateUser)(a,m);return(0,d.revalidatePath)("/admin/users"),(0,d.revalidatePath)(`/admin/users/${a}`),(0,d.revalidatePath)(`/admin/users/${a}/edit`),{success:!0,user:{id:b.id}}}catch(a){if(console.error("Failed to update user:",a),"P2002"===a.code&&a.meta?.target?.includes("username"))return{success:!1,error:"Username already exists. Please choose a different username."};return{success:!1,error:a.message||"Failed to update user. Please try again."}}}(0,a.i(713095).ensureServerEntryExports)([h,i,j]),(0,b.registerServerReference)(h,"40160121bcf677d7225fbbe6a44760ec7ddcb4f327",null),(0,b.registerServerReference)(i,"40cd9b0ea07fab0277fa7c598de4ebda31c654e9c6",null),(0,b.registerServerReference)(j,"60b9effd6d50e5332c8594e05d04b0fd7a2da46152",null),a.s(["createUserAction",()=>i,"deleteUserAction",()=>h,"updateUserAction",()=>j])},85850,a=>{"use strict";var b=a.i(466830);a.s([],531781),a.i(531781),a.s(["60b9effd6d50e5332c8594e05d04b0fd7a2da46152",()=>b.updateUserAction],85850)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__2a24e2d8._.js.map