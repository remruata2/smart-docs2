module.exports=[60555,a=>{"use strict";var b=a.i(766518);async function c(a){let c=await b.prisma.userPoints.findMany({where:{user_id:a},select:{created_at:!0},orderBy:{created_at:"desc"}});if(0===c.length)return 0;let d=Array.from(new Set(c.map(a=>new Date(a.created_at).toISOString().split("T")[0]))).sort().reverse(),e=new Date().toISOString().split("T")[0],f=new Date(Date.now()-864e5).toISOString().split("T")[0];if(!d.includes(e)&&!d.includes(f))return 0;let g=1;for(let a=0;a<d.length-1;a++){let b=new Date(d[a]),c=new Date(d[a+1]);if(1===Math.ceil(Math.abs(b.getTime()-c.getTime())/864e5))g++;else break}return g}async function d(a,c){for(let d of(await b.prisma.streakBadge.findMany({where:{is_active:!0,min_streak:{lte:c}}})))await b.prisma.userBadge.findUnique({where:{user_id_badge_id:{user_id:a,badge_id:d.id}}})||(await b.prisma.userBadge.create({data:{user_id:a,badge_id:d.id}}),console.log(`Awarded badge ${d.name} to user ${a}`))}a.s(["calculateStreak",()=>c,"checkAndAwardBadges",()=>d])}];

//# sourceMappingURL=src_lib_streak-service_ts_7b68ccb4._.js.map