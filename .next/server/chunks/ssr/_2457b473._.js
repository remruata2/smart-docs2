module.exports=[399602,696818,18956,a=>{"use strict";let b=Symbol.for("constructDateFrom");function c(a,c){return"function"==typeof a?a(c):a&&"object"==typeof a&&b in a?a[b](c):a instanceof Date?new a.constructor(c):new Date(c)}function d(a,b){return c(b||a,a)}a.s(["constructFromSymbol",0,b,"millisecondsInDay",0,864e5,"millisecondsInWeek",0,6048e5],696818),a.s(["constructFrom",()=>c],18956),a.s(["toDate",()=>d],399602)},108530,a=>{"use strict";var b=a.i(761469),c=a.i(107341),d=a.i(399602);function e(a,b){let c=(0,d.toDate)(a,b?.in);return c.setDate(1),c.setHours(0,0,0,0),c}function f(a,b){let c=(0,d.toDate)(a,b?.in),e=c.getMonth();return c.setFullYear(c.getFullYear(),e+1,0),c.setHours(23,59,59,999),c}async function g(a,d,h=1,i){let j=new Date,k=e(j),l=f(j),m=await b.db.usageTracking.findFirst({where:{user_id:a,usage_type:d,period_start:k,period_end:l}});return m?await b.db.usageTracking.update({where:{id:m.id},data:{count:m.count+h,metadata:i?{...m.metadata,...i}:null===m.metadata?c.Prisma.JsonNull:m.metadata}}):await b.db.usageTracking.create({data:{user_id:a,usage_type:d,count:h,period_start:k,period_end:l,metadata:i||{}}})}async function h(a,c){let d=new Date,g=e(d),h=f(d),i=await b.db.usageTracking.findFirst({where:{user_id:a,usage_type:c,period_start:g,period_end:h}});return i?.count||0}async function i(a){let c=new Date,d=e(c),g=f(c),h=await b.db.usageTracking.findMany({where:{user_id:a,period_start:d,period_end:g}}),i={file_upload:0,chat_message:0,document_export:0,ai_processing:0,quiz_generation:0,battle_match:0,ai_tutor_session:0};return h.forEach(a=>{i[a.usage_type]=a.count}),i}async function j(a,b,c){return await h(a,b)>=c}async function k(a,b,c){return!await j(a,b,c)}async function l(a){let c=new Date,d=e(c),g=f(c);return await b.db.usageTracking.findMany({where:{user_id:a,period_start:{gte:d,lte:g}},orderBy:{created_at:"desc"}})}a.s(["canPerformAction",()=>k,"getAllCurrentUsage",()=>i,"getCurrentUsage",()=>h,"getUserUsageStats",()=>l,"hasExceededLimit",()=>j,"trackUsage",()=>g],108530)}];

//# sourceMappingURL=_2457b473._.js.map