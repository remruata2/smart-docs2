{"version":3,"sources":["turbopack:///[project]/node_modules/openid-client/package.json","../../../../src/lib/db.ts","../../../../node_modules/next/src/server/web/spec-extension/cookies.ts","../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts","../../../../src/app/app/categories/actions.ts","../../../../.next-internal/server/app/app/categories/new/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["{\"name\":\"openid-client\",\"version\":\"5.7.1\",\"description\":\"OpenID Connect Relying Party (RP, Client) implementation for Node.js runtime, supports passportjs\",\"keywords\":[\"auth\",\"authentication\",\"basic\",\"certified\",\"client\",\"connect\",\"dynamic\",\"electron\",\"hybrid\",\"identity\",\"implicit\",\"oauth\",\"oauth2\",\"oidc\",\"openid\",\"passport\",\"relying party\",\"strategy\"],\"homepage\":\"https://github.com/panva/openid-client\",\"repository\":\"panva/openid-client\",\"funding\":{\"url\":\"https://github.com/sponsors/panva\"},\"license\":\"MIT\",\"author\":\"Filip Skokan <panva.ip@gmail.com>\",\"exports\":{\"types\":\"./types/index.d.ts\",\"import\":\"./lib/index.mjs\",\"require\":\"./lib/index.js\"},\"main\":\"./lib/index.js\",\"types\":\"./types/index.d.ts\",\"files\":[\"lib\",\"types/index.d.ts\"],\"scripts\":{\"format\":\"npx prettier --loglevel silent --write ./lib ./test ./certification ./types\",\"test\":\"mocha test/**/*.test.js\"},\"dependencies\":{\"jose\":\"^4.15.9\",\"lru-cache\":\"^6.0.0\",\"object-hash\":\"^2.2.0\",\"oidc-token-hash\":\"^5.0.3\"},\"devDependencies\":{\"@types/node\":\"^16.18.106\",\"@types/passport\":\"^1.0.16\",\"base64url\":\"^3.0.1\",\"chai\":\"^4.5.0\",\"mocha\":\"^10.7.3\",\"nock\":\"^13.5.5\",\"prettier\":\"^2.8.8\",\"readable-mock-req\":\"^0.2.2\",\"sinon\":\"^9.2.4\",\"timekeeper\":\"^2.3.1\"},\"standard-version\":{\"scripts\":{\"postchangelog\":\"sed -i '' -e 's/### \\\\[/## [/g' CHANGELOG.md\"},\"types\":[{\"type\":\"feat\",\"section\":\"Features\"},{\"type\":\"fix\",\"section\":\"Fixes\"},{\"type\":\"chore\",\"hidden\":true},{\"type\":\"docs\",\"hidden\":true},{\"type\":\"style\",\"hidden\":true},{\"type\":\"refactor\",\"section\":\"Refactor\",\"hidden\":false},{\"type\":\"perf\",\"section\":\"Performance\",\"hidden\":false},{\"type\":\"test\",\"hidden\":true}]}}","import { PrismaClient } from '../generated/prisma';\n\n// Define the global type for PrismaClient\ndeclare global {\n  var prisma: PrismaClient | undefined;\n}\n\n// PrismaClient is attached to the `global` object in development to prevent\n// exhausting your database connection limit.\nexport const db = global.prisma || new PrismaClient();\n\n// In development, keep the connection alive between hot reloads\nif (process.env.NODE_ENV !== 'production') global.prisma = db;\n","export {\n  RequestCookies,\n  ResponseCookies,\n  stringifyCookie,\n} from 'next/dist/compiled/@edge-runtime/cookies'\n","/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n","\"use server\";\n\nimport { getServerSession } from \"next-auth/next\";\nimport { authOptions } from \"@/lib/auth-options\";\nimport { db } from \"@/lib/db\";\nimport { revalidatePath } from \"next/cache\";\nimport { z } from \"zod\";\n\n// Validation schema for category data\nconst categorySchema = z.object({\n    category: z.string().min(1, \"Category is required\").max(500, \"Category must be 500 characters or less\"),\n});\n\nexport async function getCategories() {\n    const session = await getServerSession(authOptions);\n    if (!session?.user?.id) {\n        return [];\n    }\n\n    const userId = parseInt(session.user.id as string);\n\n    try {\n        const categories = await db.categoryList.findMany({\n            where: {\n                user_id: userId,\n            },\n            orderBy: { category: \"asc\" },\n        });\n        return categories;\n    } catch (error) {\n        console.error(\"Failed to fetch categories:\", error);\n        return []; // Return empty array on error\n    }\n}\n\nexport async function getCategoryById(id: number) {\n    if (isNaN(id)) return null;\n\n    const session = await getServerSession(authOptions);\n    if (!session?.user?.id) {\n        return null;\n    }\n    const userId = parseInt(session.user.id as string);\n\n    try {\n        const category = await db.categoryList.findFirst({\n            where: {\n                id,\n                user_id: userId,\n            },\n        });\n        return category;\n    } catch (error) {\n        console.error(`Failed to fetch category with id ${id}:`, error);\n        return null;\n    }\n}\n\nexport async function createCategoryAction(formData: FormData): Promise<{ success: boolean; error?: string; fieldErrors?: Record<string, string[]> }> {\n    const session = await getServerSession(authOptions);\n    if (!session?.user?.id) {\n        return { success: false, error: \"Unauthorized\" };\n    }\n    const userId = parseInt(session.user.id as string);\n\n    const rawData = {\n        category: formData.get(\"category\") as string,\n    };\n\n    const validationResult = categorySchema.safeParse(rawData);\n    if (!validationResult.success) {\n        return { success: false, error: \"Invalid data\", fieldErrors: validationResult.error.flatten().fieldErrors };\n    }\n\n    try {\n        await db.categoryList.create({\n            data: {\n                category: validationResult.data.category,\n                user_id: userId,\n            },\n        });\n        revalidatePath(\"/app/categories\");\n        return { success: true };\n    } catch (error: any) {\n        console.error(\"Failed to create category:\", error);\n        return { success: false, error: \"Failed to create category. Please try again.\" };\n    }\n}\n\nexport async function updateCategoryAction(id: number, formData: FormData): Promise<{ success: boolean; error?: string; fieldErrors?: Record<string, string[]> }> {\n    const session = await getServerSession(authOptions);\n    if (!session?.user?.id) {\n        return { success: false, error: \"Unauthorized\" };\n    }\n    const userId = parseInt(session.user.id as string);\n\n    if (isNaN(id)) {\n        return { success: false, error: \"Invalid category ID.\" };\n    }\n\n    const rawData = {\n        category: formData.get(\"category\") as string,\n    };\n\n    const validationResult = categorySchema.safeParse(rawData);\n    if (!validationResult.success) {\n        return { success: false, error: \"Invalid data\", fieldErrors: validationResult.error.flatten().fieldErrors };\n    }\n\n    try {\n        // Ensure user owns the category\n        const existing = await db.categoryList.findFirst({\n            where: { id, user_id: userId },\n        });\n\n        if (!existing) {\n            return { success: false, error: \"Category not found or unauthorized.\" };\n        }\n\n        await db.categoryList.update({\n            where: { id },\n            data: validationResult.data,\n        });\n        revalidatePath(\"/app/categories\");\n        return { success: true };\n    } catch (error: any) {\n        console.error(\"Failed to update category:\", error);\n        return { success: false, error: \"Failed to update category. Please try again.\" };\n    }\n}\n\nexport async function deleteCategoryAction(id: number): Promise<{ success: boolean; error?: string }> {\n    const session = await getServerSession(authOptions);\n    if (!session?.user?.id) {\n        return { success: false, error: \"Unauthorized\" };\n    }\n    const userId = parseInt(session.user.id as string);\n\n    if (isNaN(id)) {\n        return { success: false, error: \"Invalid category ID.\" };\n    }\n\n    try {\n        // Ensure user owns the category\n        const existing = await db.categoryList.findFirst({\n            where: { id, user_id: userId },\n        });\n\n        if (!existing) {\n            return { success: false, error: \"Category not found or unauthorized.\" };\n        }\n\n        await db.categoryList.delete({\n            where: { id },\n        });\n        revalidatePath(\"/app/categories\");\n        return { success: true };\n    } catch (error) {\n        console.error(\"Failed to delete category:\", error);\n        return { success: false, error: \"Failed to delete category. Please try again.\" };\n    }\n}\n","export {getCategories as '00a89c34df36cb71afd461c03b1c93ff3efbbd4f30'} from 'ACTIONS_MODULE0'\nexport {deleteCategoryAction as '4021dad1ca5ca54785785215b7144eec1ab1fc5e19'} from 'ACTIONS_MODULE0'\nexport {createCategoryAction as '4077b760b40cbdf46c5502789d10a65c737d28242c'} from 'ACTIONS_MODULE0'\nexport {getCategoryById as '40d96457898da1416d99e1405cfb6cfa7c623cd249'} from 'ACTIONS_MODULE0'\nexport {updateCategoryAction as '60fe7f321e10c730bb939cdf7f5c8cf4bc5121c585'} from 'ACTIONS_MODULE0'\n"],"names":["RequestCookies","ResponseCookies","stringifyCookie","registerServerReference","ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"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","ignoreList":[2,3,4]}