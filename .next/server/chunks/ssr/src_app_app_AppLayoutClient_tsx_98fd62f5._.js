module.exports=[97366,a=>{"use strict";var b=a.i(187924),c=a.i(875003),d=a.i(50944),e=a.i(572131),f=a.i(238246),g=a.i(613749),h=a.i(50522),i=a.i(953722),j=a.i(170106);let k=(0,j.default)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var l=a.i(220005);let m=(0,j.default)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var n=a.i(485552),o=a.i(583077);let p=(0,j.default)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var q=a.i(335732),r=a.i(699570),s=a.i(866718),t=a.i(57840),u=a.i(563588),v=a.i(587532),w=a.i(101239),x=a.i(781560),y=a.i(510448),z=a.i(879360),A=a.i(596221),B=a.i(823292),C=a.i(486192);function D({isCollapsed:a,onSelectConversation:c,basePath:f="/api/dashboard/conversations"}){let g,h,i,j,k,l=(0,d.useRouter)(),[m,n]=(0,e.useState)([]),[o,p]=(0,e.useState)(""),[D,E]=(0,e.useState)(!0),[F,G]=(0,e.useState)(null),[H,I]=(0,e.useState)(""),[J,K]=(0,e.useState)(!1),[L,M]=(0,e.useState)(null),[N,O]=(0,e.useState)(!1),P=async()=>{try{let a=new URLSearchParams;o&&a.append("search",o);let b=await fetch(`${f}?${a}`);if(!b.ok)throw Error("Failed to load conversations");let c=await b.json();n(c.conversations||[])}catch(a){console.error("Error loading conversations:",a),B.toast.error("Failed to load conversations")}finally{E(!1)}};(0,e.useEffect)(()=>{P()},[o]);let Q=async()=>{l.push("/app/chat")},R=a=>{c?c(a):l.push(`/app/chat?id=${a}`)},S=async(a,b)=>{try{if(!(await fetch(`${f}/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isPinned:!b})})).ok)throw Error("Failed to update conversation");B.toast.success(b?"Unpinned":"Pinned"),P()}catch(a){console.error("Error toggling pin:",a),B.toast.error("Failed to update conversation")}},T=async a=>{try{if(!(await fetch(`${f}/${a}`,{method:"DELETE"})).ok)throw Error("Failed to delete conversation");B.toast.success("Conversation deleted"),P()}catch(a){console.error("Error deleting conversation:",a),B.toast.error("Failed to delete conversation")}finally{K(!1),M(null)}},U=async(a,b)=>{if(b.trim())try{if(!(await fetch(`${f}/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:b.trim()})})).ok)throw Error("Failed to rename conversation");B.toast.success("Renamed"),P()}catch(a){console.error("Error renaming conversation:",a),B.toast.error("Failed to rename conversation")}finally{G(null),I("")}},V=async()=>{try{let a=await fetch(f,{method:"DELETE"});if(!a.ok)throw Error("Failed to delete all conversations");let b=await a.json();B.toast.success(b.message||"All conversations deleted"),P()}catch(a){console.error("Error deleting all conversations:",a),B.toast.error("Failed to delete all conversations")}finally{O(!1)}},W=((i=new Date(h=new Date((g=new Date).getFullYear(),g.getMonth(),g.getDate()))).setDate(i.getDate()-1),(j=new Date(h)).setDate(j.getDate()-7),k=[{label:"Pinned",conversations:[]},{label:"Today",conversations:[]},{label:"Yesterday",conversations:[]},{label:"Last 7 Days",conversations:[]},{label:"Older",conversations:[]}],m.forEach(a=>{if(a.isPinned)return void k[0].conversations.push(a);let b=new Date(a.lastMessageAt||a.updatedAt);b>=h?k[1].conversations.push(a):b>=i?k[2].conversations.push(a):b>=j?k[3].conversations.push(a):k[4].conversations.push(a)}),k.filter(a=>a.conversations.length>0));return(0,b.jsxs)("div",{className:"flex flex-col h-full",children:[(0,b.jsx)("div",{className:`px-2 py-2 ${a?"text-center":""}`,children:(0,b.jsxs)(r.Button,{onClick:Q,className:`w-full bg-white/20 text-white hover:bg-white/30 border border-white/10 ${a?"px-2":""}`,variant:"default",size:a?"icon":"default",title:a?"New Chat":"",children:[(0,b.jsx)(t.MessageSquarePlus,{className:`h-4 w-4 ${a?"":"mr-2"}`}),!a&&"New Chat"]})}),!a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"px-2 pb-2",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(v.Search,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-3 w-3 text-white/50"}),(0,b.jsx)(s.Input,{type:"text",placeholder:"Search...",value:o,onChange:a=>p(a.target.value),className:"pl-7 h-8 text-xs bg-white/10 border border-white/10 text-white placeholder:text-white/50 focus-visible:ring-white/30 focus-visible:ring-1"})]})}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto px-2 custom-scrollbar",children:D?(0,b.jsx)("div",{className:"flex items-center justify-center h-20",children:(0,b.jsx)(A.Loader2,{className:"h-4 w-4 animate-spin text-white/50"})}):0===W.length?(0,b.jsx)("div",{className:"p-4 text-center text-white/50 text-md",children:"No conversations yet."}):W.map(a=>(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsx)("div",{className:"px-2 py-1 text-[10px] font-semibold text-white/60 uppercase tracking-wider",children:a.label}),(0,b.jsx)("div",{className:"space-y-0.5",children:a.conversations.map(a=>(0,b.jsx)("div",{className:"group relative rounded-md transition-colors hover:bg-white/10",children:F===a.id?(0,b.jsx)("div",{className:"p-1",children:(0,b.jsx)(s.Input,{value:H,onChange:a=>I(a.target.value),onBlur:()=>U(a.id,H),onKeyDown:b=>{"Enter"===b.key?U(a.id,H):"Escape"===b.key&&(G(null),I(""))},autoFocus:!0,className:"h-6 text-sm bg-white text-gray-900"})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>R(a.id),className:"w-full text-left px-2 py-1.5 pr-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[a.isPinned&&(0,b.jsx)(w.Pin,{className:"h-3 w-3 text-white/70 flex-shrink-0"}),(0,b.jsx)("div",{className:"flex-1 min-w-0",children:(0,b.jsx)("div",{className:"text-sm font-medium text-white truncate group-hover:text-white",children:a.title})})]})}),(0,b.jsx)("div",{className:"absolute right-1 top-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,b.jsxs)(q.DropdownMenu,{children:[(0,b.jsx)(q.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(r.Button,{variant:"ghost",size:"icon",className:"h-5 w-5 text-white/50 hover:text-white hover:bg-white/20",children:(0,b.jsx)(z.MoreVertical,{className:"h-3 w-3"})})}),(0,b.jsxs)(q.DropdownMenuContent,{align:"end",className:"w-32 bg-white border border-gray-200 text-gray-800",children:[(0,b.jsxs)(q.DropdownMenuItem,{onClick:()=>{G(a.id),I(a.title)},className:"text-xs focus:bg-gray-100 focus:text-gray-900",children:[(0,b.jsx)(y.Edit2,{className:"h-3 w-3 mr-2"}),"Rename"]}),(0,b.jsxs)(q.DropdownMenuItem,{onClick:()=>S(a.id,a.isPinned),className:"text-xs focus:bg-gray-100 focus:text-gray-900",children:[(0,b.jsx)(w.Pin,{className:"h-3 w-3 mr-2"}),a.isPinned?"Unpin":"Pin"]}),(0,b.jsxs)(q.DropdownMenuItem,{onClick:()=>{M(a.id),K(!0)},className:"text-xs text-red-500 focus:bg-gray-100 focus:text-red-600",children:[(0,b.jsx)(x.Trash2,{className:"h-3 w-3 mr-2"}),"Delete"]})]})]})})]})},a.id))})]},a.label))})]}),a&&(0,b.jsx)("div",{className:"flex-1 flex flex-col items-center py-2 gap-2 overflow-y-auto custom-scrollbar",children:m.slice(0,10).map(a=>(0,b.jsx)("button",{onClick:()=>R(a.id),className:"w-8 h-8 rounded-md flex items-center justify-center transition-colors hover:bg-white/20 text-white/70 hover:text-white",title:a.title,children:(0,b.jsx)(u.MessageSquare,{className:"h-4 w-4"})},a.id))}),!a&&m.length>0&&(0,b.jsx)("div",{className:"p-2 border-t border-white/10",children:(0,b.jsxs)(r.Button,{variant:"ghost",size:"sm",className:"w-full text-xs text-red-300 hover:text-red-200 hover:bg-red-500/20 justify-start px-2",onClick:()=>O(!0),children:[(0,b.jsx)(x.Trash2,{className:"h-3 w-3 mr-2"}),"Clear History"]})}),(0,b.jsx)(C.AlertDialog,{open:N,onOpenChange:O,children:(0,b.jsxs)(C.AlertDialogContent,{children:[(0,b.jsxs)(C.AlertDialogHeader,{children:[(0,b.jsx)(C.AlertDialogTitle,{children:"Delete All Conversations?"}),(0,b.jsxs)(C.AlertDialogDescription,{children:["This will permanently delete all ",m.length," ","conversation",1!==m.length?"s":""," and all their messages. This action cannot be undone."]})]}),(0,b.jsxs)(C.AlertDialogFooter,{children:[(0,b.jsx)(C.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(C.AlertDialogAction,{onClick:V,className:"bg-red-600 hover:bg-red-700",children:"Delete All"})]})]})}),(0,b.jsx)(C.AlertDialog,{open:J,onOpenChange:K,children:(0,b.jsxs)(C.AlertDialogContent,{children:[(0,b.jsxs)(C.AlertDialogHeader,{children:[(0,b.jsx)(C.AlertDialogTitle,{children:"Delete Conversation?"}),(0,b.jsx)(C.AlertDialogDescription,{children:"This will permanently delete the conversation and all its messages. This action cannot be undone."})]}),(0,b.jsxs)(C.AlertDialogFooter,{children:[(0,b.jsx)(C.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(C.AlertDialogAction,{onClick:()=>L&&T(L),className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})}function E({setSidebarOpen:a}){let{data:j}=(0,c.useSession)(),r=(0,d.usePathname)(),[s,t]=(0,e.useState)(!1),u="flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors duration-200",v=!!a,w=!v&&s;return(0,b.jsxs)("div",{className:`flex flex-col h-screen sticky top-0 bg-gradient-to-b from-indigo-800 to-indigo-950 text-white border-r border-white/10 transition-all duration-300 ease-in-out ${w?"w-16":"w-64"}`,children:[!v&&(0,b.jsx)("button",{onClick:()=>t(!s),className:"absolute right-0 top-8 -translate-y-1/2 translate-x-1/2 transform z-10 bg-white border border-gray-200 rounded-full h-5 w-5 flex items-center justify-center hover:bg-gray-100 text-violet-600 shadow-md transition-colors",title:s?"Expand sidebar":"Collapse sidebar",children:s?(0,b.jsx)(h.ChevronRight,{className:"h-4 w-4"}):(0,b.jsx)(g.ChevronLeft,{className:"h-4 w-4"})}),(0,b.jsx)("div",{className:"flex-shrink-0 px-4 py-4 flex items-center justify-between h-16",children:w?(0,b.jsx)("div",{className:"w-full flex justify-center",children:(0,b.jsx)("span",{className:"text-lg font-bold text-white",children:"SD"})}):(0,b.jsxs)("h1",{className:"text-xl font-bold text-white tracking-tight flex items-center gap-2",children:[(0,b.jsx)(n.BrainCircuit,{className:"w-6 h-6"}),"Zirna"]})}),(0,b.jsxs)("nav",{className:"flex-shrink-0 px-2 py-4 space-y-1",children:[(0,b.jsxs)(f.default,{href:"/app/dashboard",onClick:()=>a&&a(!1),className:`${u} ${r.startsWith("/app/dashboard")?"bg-white/20 text-white shadow-sm":"text-white/70 hover:bg-white/10 hover:text-white"} ${w?"justify-center px-0":""}`,title:w?"Dashboard":"",children:[(0,b.jsx)(k,{className:`${w?"h-5 w-5":"mr-3 h-5 w-5"}`}),!w&&"Dashboard"]}),(0,b.jsxs)(f.default,{href:"/app/subjects",onClick:()=>a&&a(!1),className:`${u} ${r.startsWith("/app/subjects")||r.startsWith("/app/chapters")?"bg-white/20 text-white shadow-sm":"text-white/70 hover:bg-white/10 hover:text-white"} ${w?"justify-center px-0":""}`,title:w?"Subjects":"",children:[(0,b.jsx)(i.BookOpen,{className:`${w?"h-5 w-5":"mr-3 h-5 w-5"}`}),!w&&"Subjects"]}),(0,b.jsxs)(f.default,{href:"/app/practice",onClick:()=>a&&a(!1),className:`${u} ${"/app/practice"===r?"bg-white/20 text-white shadow-sm":"text-white/70 hover:bg-white/10 hover:text-white"} ${w?"justify-center px-0":""}`,title:w?"Practice":"",children:[(0,b.jsx)(n.BrainCircuit,{className:`${w?"h-5 w-5":"mr-3 h-5 w-5"}`}),!w&&"Practice"]}),(0,b.jsxs)(f.default,{href:"/app/practice/history",onClick:()=>a&&a(!1),className:`${u} ${r.startsWith("/app/practice/history")?"bg-white/20 text-white shadow-sm":"text-white/70 hover:bg-white/10 hover:text-white"} ${w?"justify-center px-0":""}`,title:w?"Quiz History":"",children:[(0,b.jsx)(p,{className:`${w?"h-5 w-5":"mr-3 h-5 w-5"}`}),!w&&"Quiz History"]}),(0,b.jsxs)(f.default,{href:"/app/leaderboard",onClick:()=>a&&a(!1),className:`${u} ${r.startsWith("/app/leaderboard")?"bg-white/20 text-white shadow-sm":"text-white/70 hover:bg-white/10 hover:text-white"} ${w?"justify-center px-0":""}`,title:w?"Leaderboard":"",children:[(0,b.jsx)(o.Trophy,{className:`${w?"h-5 w-5":"mr-3 h-5 w-5"}`}),!w&&"Leaderboard"]})]}),(0,b.jsx)("div",{className:"px-4 py-2",children:(0,b.jsx)("div",{className:"h-px bg-white/20"})}),(0,b.jsxs)("div",{className:"flex-1 min-h-0 overflow-hidden flex flex-col",children:[!w&&(0,b.jsx)("div",{className:"px-4 py-2 text-xs font-semibold text-white/60 uppercase tracking-wider",children:"History"}),(0,b.jsx)(D,{isCollapsed:w})]}),(0,b.jsx)("div",{className:"flex-shrink-0 bg-transparent",children:(0,b.jsxs)("div",{className:`p-4 ${w?"px-2":""}`,children:[(0,b.jsxs)("div",{className:"flex items-center mb-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:(0,b.jsx)("div",{className:"h-8 w-8 rounded-full bg-white/20 flex items-center justify-center border border-white/10",children:(0,b.jsx)("span",{className:"text-sm font-medium text-white",children:j?.user.username?.charAt(0).toUpperCase()||"U"})})}),!w&&(0,b.jsxs)("div",{className:"ml-3 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-white truncate",children:j?.user.username||"User"}),(0,b.jsx)("p",{className:"text-xs text-white/60 truncate",children:"User Account"})]})]}),(0,b.jsxs)(q.DropdownMenu,{children:[(0,b.jsx)(q.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)("button",{className:"w-full flex items-center justify-center rounded-full p-3 bg-white/10 border border-white/10 text-white hover:bg-white/20 transition backdrop-blur-sm",title:"Settings",children:[(0,b.jsx)(m,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Settings"})]})}),(0,b.jsxs)(q.DropdownMenuContent,{align:"end",className:"w-40 bg-white border border-gray-200 text-gray-800",children:[(0,b.jsx)(q.DropdownMenuItem,{asChild:!0,children:(0,b.jsx)(f.default,{href:"/app/profile",className:"w-full cursor-pointer text-sm hover:bg-gray-100",children:"Account Settings"})}),(0,b.jsx)(q.DropdownMenuItem,{asChild:!0,children:(0,b.jsx)(f.default,{href:"/app/usage",className:"w-full cursor-pointer text-sm hover:bg-gray-100",children:"Usage & Limits"})}),(0,b.jsxs)(q.DropdownMenuItem,{onClick:()=>(0,c.signOut)({callbackUrl:"/login"}),className:"text-sm text-red-500 hover:bg-red-50 focus:text-red-600 focus:bg-red-50",children:[(0,b.jsx)(l.LogOut,{className:"mr-2 h-4 w-4"}),"Sign out"]})]})]})]})})]})}var F=a.i(426419),G=a.i(681010),H=a.i(162041),I=a.i(419221);function J(){let a=(0,d.usePathname)(),c=b=>a===b||a?.startsWith(b+"/");return(0,b.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 flex justify-around p-2 pb-safe md:hidden z-50 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]",children:[(0,b.jsxs)(f.default,{href:"/app/dashboard",className:`flex flex-col items-center p-2 rounded-lg transition-colors ${c("/app/dashboard")?"text-primary":"text-gray-400 hover:text-gray-600"}`,children:[(0,b.jsx)(G.Home,{className:"w-6 h-6 mb-1"}),(0,b.jsx)("span",{className:"text-[10px] font-medium",children:"Home"})]}),(0,b.jsxs)(f.default,{href:"/app/subjects",className:`flex flex-col items-center p-2 rounded-lg transition-colors ${c("/app/subjects")||c("/app/chapters")?"text-primary":"text-gray-400 hover:text-gray-600"}`,children:[(0,b.jsx)(i.BookOpen,{className:"w-6 h-6 mb-1"}),(0,b.jsx)("span",{className:"text-[10px] font-medium",children:"Study"})]}),(0,b.jsxs)("div",{className:"relative -top-6",children:[(0,b.jsx)(f.default,{href:"/app/practice/battle",className:`flex flex-col items-center justify-center w-14 h-14 rounded-full shadow-lg border-4 border-gray-50 transition-transform hover:scale-105 ${c("/app/practice/battle")?"bg-purple-600 text-white":"bg-gradient-to-br from-purple-500 to-indigo-600 text-white"}`,children:(0,b.jsx)(I.Swords,{className:"w-6 h-6"})}),(0,b.jsx)("span",{className:"absolute -bottom-6 left-1/2 -translate-x-1/2 text-[10px] font-medium text-purple-700 whitespace-nowrap",children:"Battle"})]}),(0,b.jsxs)(f.default,{href:"/app/practice",className:`flex flex-col items-center p-2 rounded-lg transition-colors ${c("/app/practice")?"text-primary":"text-gray-400 hover:text-gray-600"}`,children:[(0,b.jsx)(n.BrainCircuit,{className:"w-6 h-6 mb-1"}),(0,b.jsx)("span",{className:"text-[10px] font-medium",children:"Practice"})]}),(0,b.jsxs)(f.default,{href:"/app/profile",className:`flex flex-col items-center p-2 rounded-lg transition-colors ${c("/app/profile")?"text-primary":"text-gray-400 hover:text-gray-600"}`,children:[(0,b.jsx)(H.User,{className:"w-6 h-6 mb-1"}),(0,b.jsx)("span",{className:"text-[10px] font-medium",children:"Profile"})]})]})}function K({children:a}){let{data:f,status:g}=(0,c.useSession)(),h=(0,d.useRouter)();return((0,e.useEffect)(()=>{"loading"!==g&&(f||h.push("/login"))},[f,g,h]),"loading"===g)?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):f?(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50 flex",children:[(0,b.jsx)(F.Toaster,{richColors:!0,position:"top-right"}),(0,b.jsx)("div",{className:"hidden lg:flex lg:flex-shrink-0",children:(0,b.jsx)(E,{})}),(0,b.jsx)("div",{className:"flex flex-col w-0 flex-1 overflow-hidden",children:(0,b.jsx)("main",{className:"flex-1 relative z-0 overflow-y-auto focus:outline-none pb-16 lg:pb-0",children:a})}),(0,b.jsx)(J,{})]}):null}a.s(["default",()=>K],97366)}];

//# sourceMappingURL=src_app_app_AppLayoutClient_tsx_98fd62f5._.js.map