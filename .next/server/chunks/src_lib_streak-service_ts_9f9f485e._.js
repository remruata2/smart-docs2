module.exports=[108034,e=>{"use strict";var t=e.i(698043);async function a(e){let a=await t.prisma.userPoints.findMany({where:{user_id:e},select:{created_at:!0},orderBy:{created_at:"desc"}});if(0===a.length)return 0;let r=Array.from(new Set(a.map(e=>new Date(e.created_at).toISOString().split("T")[0]))).sort().reverse(),i=new Date().toISOString().split("T")[0],s=new Date(Date.now()-864e5).toISOString().split("T")[0];if(!r.includes(i)&&!r.includes(s))return 0;let n=1;for(let e=0;e<r.length-1;e++){let t=new Date(r[e]),a=new Date(r[e+1]);if(1===Math.ceil(Math.abs(t.getTime()-a.getTime())/864e5))n++;else break}return n}async function r(e,a){for(let r of(await t.prisma.streakBadge.findMany({where:{is_active:!0,min_streak:{lte:a}}})))await t.prisma.userBadge.findUnique({where:{user_id_badge_id:{user_id:e,badge_id:r.id}}})||(await t.prisma.userBadge.create({data:{user_id:e,badge_id:r.id}}),console.log(`Awarded badge ${r.name} to user ${e}`))}e.s(["calculateStreak",()=>a,"checkAndAwardBadges",()=>r])}];

//# sourceMappingURL=src_lib_streak-service_ts_9f9f485e._.js.map