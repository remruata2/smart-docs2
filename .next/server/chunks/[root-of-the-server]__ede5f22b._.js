module.exports=[193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},843793,e=>{"use strict";var t=e.i(660724);let r=global.prisma||new t.PrismaClient;e.s(["db",0,r])},698043,e=>{"use strict";let t=e.i(843793).db;e.s(["default",0,t,"prisma",0,t])},145706,(e,t,r)=>{t.exports=e.x("querystring",()=>require("querystring"))},575096,e=>{e.v({name:"openid-client",version:"5.7.1",description:"OpenID Connect Relying Party (RP, Client) implementation for Node.js runtime, supports passportjs",keywords:["auth","authentication","basic","certified","client","connect","dynamic","electron","hybrid","identity","implicit","oauth","oauth2","oidc","openid","passport","relying party","strategy"],homepage:"https://github.com/panva/openid-client",repository:"panva/openid-client",funding:{url:"https://github.com/sponsors/panva"},license:"MIT",author:"Filip Skokan <panva.ip@gmail.com>",exports:{types:"./types/index.d.ts",import:"./lib/index.mjs",require:"./lib/index.js"},main:"./lib/index.js",types:"./types/index.d.ts",files:["lib","types/index.d.ts"],scripts:{format:"npx prettier --loglevel silent --write ./lib ./test ./certification ./types",test:"mocha test/**/*.test.js"},dependencies:{jose:"^4.15.9","lru-cache":"^6.0.0","object-hash":"^2.2.0","oidc-token-hash":"^5.0.3"},devDependencies:{"@types/node":"^16.18.106","@types/passport":"^1.0.16",base64url:"^3.0.1",chai:"^4.5.0",mocha:"^10.7.3",nock:"^13.5.5",prettier:"^2.8.8","readable-mock-req":"^0.2.2",sinon:"^9.2.4",timekeeper:"^2.3.1"},"standard-version":{scripts:{postchangelog:"sed -i '' -e 's/### \\[/## [/g' CHANGELOG.md"},types:[{type:"feat",section:"Features"},{type:"fix",section:"Fixes"},{type:"chore",hidden:!0},{type:"docs",hidden:!0},{type:"style",hidden:!0},{type:"refactor",section:"Refactor",hidden:!1},{type:"perf",section:"Performance",hidden:!1},{type:"test",hidden:!0}]}})},500874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},449719,(e,t,r)=>{t.exports=e.x("assert",()=>require("assert"))},792509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},814747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},224361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},406461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},427699,(e,t,r)=>{t.exports=e.x("events",()=>require("events"))},522734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},750227,(e,t,r)=>{t.exports=e.x("node:path",()=>require("node:path"))},59639,(e,t,r)=>{t.exports=e.x("node:process",()=>require("node:process"))},660526,(e,t,r)=>{t.exports=e.x("node:os",()=>require("node:os"))},509656,(e,t,r)=>{t.exports=e.x("node:tty",()=>require("node:tty"))},902157,(e,t,r)=>{t.exports=e.x("node:fs",()=>require("node:fs"))},666680,(e,t,r)=>{t.exports=e.x("node:crypto",()=>require("node:crypto"))},874533,(e,t,r)=>{t.exports=e.x("node:child_process",()=>require("node:child_process"))},912714,(e,t,r)=>{t.exports=e.x("node:fs/promises",()=>require("node:fs/promises"))},812057,(e,t,r)=>{t.exports=e.x("node:util",()=>require("node:util"))},478500,(e,t,r)=>{t.exports=e.x("node:async_hooks",()=>require("node:async_hooks"))},687769,(e,t,r)=>{t.exports=e.x("node:events",()=>require("node:events"))},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},921517,(e,t,r)=>{t.exports=e.x("http",()=>require("http"))},524836,(e,t,r)=>{t.exports=e.x("https",()=>require("https"))},916020,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},757660,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={};Object.defineProperty(r,"default",{enumerable:!0,get:function(){return o.default}});var s=e.r(916020);Object.keys(s).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e)||e in r&&r[e]===s[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return s[e]}})});var o=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(void 0);if(r&&r.has(e))return r.get(e);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&({}).hasOwnProperty.call(e,o)){var i=s?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}(e.r(823667));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e)||e in r&&r[e]===o[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return o[e]}})})},442461,e=>e.a(async(t,r)=>{try{let t=await e.y("@xenova/transformers");e.n(t),r()}catch(e){r(e)}},!0),924868,(e,t,r)=>{t.exports=e.x("fs/promises",()=>require("fs/promises"))},446786,(e,t,r)=>{t.exports=e.x("os",()=>require("os"))},870722,(e,t,r)=>{t.exports=e.x("tty",()=>require("tty"))},799160,e=>e.a(async(t,r)=>{try{var n=e.i(442461),s=e.i(843793),o=t([n]);[n]=o.then?(await o)():o;let a="Xenova/all-MiniLM-L6-v2";class i{static embedder=null;static async initialize(){this.embedder||(console.log(`[SEMANTIC] Initializing local embedder model: ${a}...`),this.embedder=await (0,n.pipeline)("feature-extraction",a),console.log("[SEMANTIC] Embedder initialized successfully"))}static async generateEmbedding(e){if(await this.initialize(),!e||!e.trim())throw Error("Text is required for embedding generation");let t=e.replace(/\n+/g," ").trim().substring(0,2e3);try{let e=await this.embedder(t,{pooling:"mean",normalize:!0});return Array.from(e.data)}catch(e){throw console.error("[SEMANTIC] Error generating embedding:",e),e}}static async updateSemanticVector(e){try{let t=await s.db.fileList.findUnique({where:{id:e},select:{title:!0,category:!0,note:!0}});if(!t)throw Error(`File with ID ${e} not found`);let r=`Title: ${t.title}. Category: ${t.category}. Content: ${t.note||""}`;console.log(`[SEMANTIC] Generating vector for file ${e} (${r.length} chars)...`);let n=await this.generateEmbedding(r);await s.db.$executeRaw`
				UPDATE file_list
				SET semantic_vector = ${JSON.stringify(n)}::vector
				WHERE id = ${e}
			`,console.log(`[SEMANTIC] Successfully updated vector for file ${e}`)}catch(t){console.error(`[SEMANTIC] Failed to update vector for file ${e}:`,t)}}static async generateChunkVectors(e){try{let t=await s.db.fileChunk.findMany({where:{file_id:e},select:{id:!0,content:!0}});for(let r of(console.log(`[SEMANTIC] Generating vectors for ${t.length} chunks of file ${e}...`),t))try{let e=await this.generateEmbedding(r.content);await s.db.$executeRaw`
						UPDATE file_chunks
						SET semantic_vector = ${JSON.stringify(e)}::vector
						WHERE id = ${r.id}
					`}catch(e){console.error(`[SEMANTIC] Failed to generate vector for chunk ${r.id}:`,e)}console.log(`[SEMANTIC] Successfully updated vectors for file ${e} chunks`)}catch(t){console.error(`[SEMANTIC] Failed to generate chunk vectors for file ${e}:`,t)}}static async batchUpdateSemanticVectors(){console.log("[SEMANTIC] Starting batch update for missing vectors...");let e=await s.db.$queryRaw`
			SELECT id FROM file_list WHERE semantic_vector IS NULL
		`;for(let t of(console.log(`[SEMANTIC] Found ${e.length} records to update.`),e))await this.updateSemanticVector(t.id);console.log("[SEMANTIC] Batch update completed.")}}e.s(["SemanticVectorService",()=>i]),r()}catch(e){r(e)}},!1),484199,(e,t,r)=>{"use strict";var n=Object.defineProperty,s=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={},l={VercelOidcTokenError:()=>u};for(var c in l)n(i,c,{get:l[c],enumerable:!0});t.exports=((e,t,r,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of o(t))a.call(e,r)||void 0===r||n(e,r,{get:()=>t[r],enumerable:!(i=s(t,r))||i.enumerable});return e})(n({},"__esModule",{value:!0}),i);class u extends Error{constructor(e,t){super(e),this.name="VercelOidcTokenError",this.cause=t}toString(){return this.cause?`${this.name}: ${this.message}: ${this.cause}`:`${this.name}: ${this.message}`}}},168031,e=>{"use strict";var t=e.i(698043);let r=null;async function n(){return r||(r=(async()=>{try{await t.default.$executeRawUnsafe("SELECT pg_advisory_lock(hashtext('cid_ai_app_settings_ddl_lock'));");try{await t.default.$executeRawUnsafe(`CREATE TABLE IF NOT EXISTS app_settings (
            key TEXT PRIMARY KEY,
            value TEXT NOT NULL,
            created_at TIMESTAMPTZ DEFAULT NOW(),
            updated_at TIMESTAMPTZ DEFAULT NOW()
          );`),await t.default.$executeRawUnsafe(`CREATE OR REPLACE FUNCTION set_updated_at()
           RETURNS TRIGGER AS $$
           BEGIN
             NEW.updated_at = NOW();
             RETURN NEW;
           END;
           $$ LANGUAGE plpgsql;`),await t.default.$executeRawUnsafe(`DO $$
           BEGIN
             IF NOT EXISTS (
               SELECT 1 FROM pg_trigger WHERE tgname = 'app_settings_set_updated_at'
             ) THEN
               CREATE TRIGGER app_settings_set_updated_at
               BEFORE UPDATE ON app_settings
               FOR EACH ROW EXECUTE FUNCTION set_updated_at();
             END IF;
           END $$;`)}finally{await t.default.$executeRawUnsafe("SELECT pg_advisory_unlock(hashtext('cid_ai_app_settings_ddl_lock'));")}}catch(e){console.warn("[APP-SETTINGS] ensureTable failed (non-fatal)",e)}})())}async function s(e){try{await n();let r=await t.default.$queryRawUnsafe("SELECT value FROM app_settings WHERE key = $1 LIMIT 1",e);if(r&&r.length>0)return r[0].value;return null}catch(e){return console.warn("[APP-SETTINGS] getSetting failed",e),null}}async function o(e,r){await n(),await t.default.$executeRawUnsafe(`INSERT INTO app_settings (key, value)
     VALUES ($1, $2)
     ON CONFLICT (key) DO UPDATE SET value = EXCLUDED.value`,e,r)}async function a(e,t){let r=await s(e);if(null==r)return t;let n=Number(r);return!Number.isFinite(n)||n<=0?t:Math.floor(n)}async function i(e,t){if(!Number.isFinite(t)||t<=0)throw Error("Value must be a positive integer");await o(e,String(Math.floor(t)))}e.s(["getSettingInt",()=>a,"setSettingInt",()=>i])},141528,(e,t,r)=>{function n(e,t,r,n){return Math.round(e/r)+" "+n+(t>=1.5*r?"s":"")}t.exports=function(e,t){t=t||{};var r,s,o,a,i=typeof e;if("string"===i&&e.length>0){var l=e;if(!((l=String(l)).length>100)){var c=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(l);if(c){var u=parseFloat(c[1]);switch((c[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*u;case"weeks":case"week":case"w":return 6048e5*u;case"days":case"day":case"d":return 864e5*u;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*u;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*u;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*u;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:break}}}return}if("number"===i&&isFinite(e)){return t.long?(s=Math.abs(r=e))>=864e5?n(r,s,864e5,"day"):s>=36e5?n(r,s,36e5,"hour"):s>=6e4?n(r,s,6e4,"minute"):s>=1e3?n(r,s,1e3,"second"):r+" ms":(a=Math.abs(o=e))>=864e5?Math.round(o/864e5)+"d":a>=36e5?Math.round(o/36e5)+"h":a>=6e4?Math.round(o/6e4)+"m":a>=1e3?Math.round(o/1e3)+"s":o+"ms"}throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},916525,(e,t,r)=>{t.exports=function(t){function r(e){let t,s,o,a=null;function i(...e){if(!i.enabled)return;let n=Number(new Date);i.diff=n-(t||n),i.prev=t,i.curr=n,t=n,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(t,n)=>{if("%%"===t)return"%";s++;let o=r.formatters[n];if("function"==typeof o){let r=e[s];t=o.call(i,r),e.splice(s,1),s--}return t}),r.formatArgs.call(i,e),(i.log||r.log).apply(i,e)}return i.namespace=e,i.useColors=r.useColors(),i.color=r.selectColor(e),i.extend=n,i.destroy=r.destroy,Object.defineProperty(i,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(s!==r.namespaces&&(s=r.namespaces,o=r.enabled(e)),o),set:e=>{a=e}}),"function"==typeof r.init&&r.init(i),i}function n(e,t){let n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function s(e,t){let r=0,n=0,s=-1,o=0;for(;r<e.length;)if(n<t.length&&(t[n]===e[r]||"*"===t[n]))"*"===t[n]?(s=n,o=r):r++,n++;else{if(-1===s)return!1;n=s+1,r=++o}for(;n<t.length&&"*"===t[n];)n++;return n===t.length}return r.debug=r,r.default=r,r.coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){let e=[...r.names,...r.skips.map(e=>"-"+e)].join(",");return r.enable(""),e},r.enable=function(e){for(let t of(r.save(e),r.namespaces=e,r.names=[],r.skips=[],("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean)))"-"===t[0]?r.skips.push(t.slice(1)):r.names.push(t)},r.enabled=function(e){for(let t of r.skips)if(s(e,t))return!1;for(let t of r.names)if(s(e,t))return!0;return!1},r.humanize=e.r(141528),r.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(e=>{r[e]=t[e]}),r.names=[],r.skips=[],r.formatters={},r.selectColor=function(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return r.colors[Math.abs(t)%r.colors.length]},r.enable(r.load()),r}},855225,(e,t,r)=>{"use strict";t.exports=(e,t=process.argv)=>{let r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),s=t.indexOf("--");return -1!==n&&(-1===s||n<s)}},181042,(e,t,r)=>{"use strict";let n;e.r(446786);let s=e.r(870722),o=e.r(855225),{env:a}=process;function i(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function l(e,t){if(0===n)return 0;if(o("color=16m")||o("color=full")||o("color=truecolor"))return 3;if(o("color=256"))return 2;if(e&&!t&&void 0===n)return 0;let r=n||0;if("dumb"===a.TERM)return r;if("CI"in a)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(e=>e in a)||"codeship"===a.CI_NAME?1:r;if("TEAMCITY_VERSION"in a)return+!!/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(a.TEAMCITY_VERSION);if("truecolor"===a.COLORTERM)return 3;if("TERM_PROGRAM"in a){let e=parseInt((a.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(a.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(a.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(a.TERM)||"COLORTERM"in a?1:r}o("no-color")||o("no-colors")||o("color=false")||o("color=never")?n=0:(o("color")||o("colors")||o("color=true")||o("color=always"))&&(n=1),"FORCE_COLOR"in a&&(n="true"===a.FORCE_COLOR?1:"false"===a.FORCE_COLOR?0:0===a.FORCE_COLOR.length?1:Math.min(parseInt(a.FORCE_COLOR,10),3)),t.exports={supportsColor:function(e){return i(l(e,e&&e.isTTY))},stdout:i(l(!0,s.isatty(1))),stderr:i(l(!0,s.isatty(2)))}},523440,(e,t,r)=>{let n=e.r(870722),s=e.r(224361);r.init=function(e){e.inspectOpts={};let t=Object.keys(r.inspectOpts);for(let n=0;n<t.length;n++)e.inspectOpts[t[n]]=r.inspectOpts[t[n]]},r.log=function(...e){return process.stderr.write(s.formatWithOptions(r.inspectOpts,...e)+"\n")},r.formatArgs=function(e){let{namespace:n,useColors:s}=this;if(s){let r=this.color,s="\x1b[3"+(r<8?r:"8;5;"+r),o=`  ${s};1m${n} \u001B[0m`;e[0]=o+e[0].split("\n").join("\n"+o),e.push(s+"m+"+t.exports.humanize(this.diff)+"\x1b[0m")}else e[0]=(r.inspectOpts.hideDate?"":new Date().toISOString()+" ")+n+" "+e[0]},r.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},r.load=function(){return process.env.DEBUG},r.useColors=function(){return"colors"in r.inspectOpts?!!r.inspectOpts.colors:n.isatty(process.stderr.fd)},r.destroy=s.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),r.colors=[6,2,3,4,5,1];try{let t=e.r(181042);t&&(t.stderr||t).level>=2&&(r.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}r.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{let r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(e,t)=>t.toUpperCase()),n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e},{}),t.exports=e.r(916525)(r);let{formatters:o}=t.exports;o.o=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts).split("\n").map(e=>e.trim()).join(" ")},o.O=function(e){return this.inspectOpts.colors=this.useColors,s.inspect(e,this.inspectOpts)}},328452,(e,t,r)=>{let n;r.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;e.splice(1,0,r,"color: inherit");let n=0,s=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(n++,"%c"===e&&(s=n))}),e.splice(s,0,r)},r.save=function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch(e){}},r.load=function(){let e;try{e=r.storage.getItem("debug")||r.storage.getItem("DEBUG")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},r.useColors=function(){let e;return!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},r.storage=function(){try{return localStorage}catch(e){}}(),n=!1,r.destroy=()=>{n||(n=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))},r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.log=console.debug||console.log||(()=>{}),t.exports=e.r(916525)(r);let{formatters:s}=t.exports;s.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},817293,(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||process.__nwjs?t.exports=e.r(328452):t.exports=e.r(523440)},857764,(e,t,r)=>{t.exports=e.x("node:url",()=>require("node:url"))},57328,(e,t,r)=>{t.exports=e.x("node:assert",()=>require("node:assert"))},81111,(e,t,r)=>{t.exports=e.x("node:stream",()=>require("node:stream"))},844376,(e,t,r)=>{t.exports=e.x("node:module",()=>require("node:module"))},524909,787174,e=>{"use strict";var t=e.i(750227);e.s(["path",()=>t.default],524909);var r=e.i(912714);e.s(["fs",()=>r.default],787174)},605365,(e,t,r)=>{t.exports=e.x("process",()=>require("process"))},949934,e=>e.a(async(t,r)=>{try{var n=e.i(89171),s=e.i(757660),o=e.i(856292),a=e.i(698043),i=e.i(946502),l=e.i(292938),c=e.i(924868),u=e.i(814747),d=e.i(446786),p=t([i]);async function f(e){try{let t=await (0,s.getServerSession)(o.authOptions);if(!t?.user?.role||"admin"!==t.user.role)return n.NextResponse.json({error:"Unauthorized"},{status:401});let r=await e.formData(),p=r.get("file"),f=r.get("subjectId"),h=r.get("chapterId");if(!p||!f||!h)return n.NextResponse.json({error:"Missing required fields"},{status:400});let g=Buffer.from(await p.arrayBuffer()),m=u.default.join(d.default.tmpdir(),`upload-${Date.now()}-${p.name}`);await (0,c.writeFile)(m,g);try{console.log("[UPLOAD] Parsing PDF with LlamaParse...");let e=new l.LlamaParseDocumentParser,t=(await e.parseFile(m,{fastMode:!1,parsingInstruction:"Extract questions and diagrams. Ignore Hindi text."})).map(e=>e.md||e.text).join("\n\n");if(!t||0===t.trim().length)throw Error("Parsed PDF content is empty");console.log("[UPLOAD] Extracting questions...");let r=await (0,i.extractQuestionsFromPaper)(t);console.log("[UPLOAD] Fetching chapter context..."),(await a.prisma.chapterChunk.findMany({where:{chapter_id:parseInt(h)},select:{content:!0},take:20})).map(e=>e.content).join("\n\n"),console.log(`[UPLOAD] Extracted ${r.length} questions. Returning for review...`);let s=r.map(e=>({...e,correct_answer:"",explanation:"",chapter_id:parseInt(h),subject_id:parseInt(f)}));return n.NextResponse.json({success:!0,questions:s})}finally{await (0,c.unlink)(m).catch(console.error)}}catch(e){return console.error("[UPLOAD] Error processing upload:",e),n.NextResponse.json({error:e.message||"Failed to process upload"},{status:500})}}[i]=p.then?(await p)():p,e.s(["POST",()=>f]),r()}catch(e){r(e)}},!1),432520,e=>e.a(async(t,r)=>{try{var n=e.i(747909),s=e.i(174017),o=e.i(996250),a=e.i(759756),i=e.i(561916),l=e.i(114444),c=e.i(837092),u=e.i(869741),d=e.i(316795),p=e.i(487718),f=e.i(995169),h=e.i(47587),g=e.i(666012),m=e.i(570101),C=e.i(626937),y=e.i(10372),x=e.i(193695);e.i(52474);var E=e.i(257297),v=e.i(949934),b=t([v]);[v]=b.then?(await b)():b;let O=new n.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/admin/questions/upload/route",pathname:"/api/admin/questions/upload",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/admin/questions/upload/route.ts",nextConfigOutput:"",userland:v}),{workAsyncStorage:_,workUnitAsyncStorage:F,serverHooks:T}=O;function w(){return(0,o.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:F})}async function R(e,t,r){O.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/admin/questions/upload/route";n=n.replace(/\/index$/,"")||"/";let o=await O.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!o)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:v,params:b,nextConfig:w,parsedUrl:R,isDraftMode:_,prerenderManifest:F,routerServerContext:T,isOnDemandRevalidate:A,revalidateOnlyGenerated:I,resolvedPathname:N,clientReferenceManifest:S,serverActionsManifest:M}=o,P=(0,u.normalizeAppPath)(n),k=!!(F.dynamicRoutes[P]||F.routes[N]),j=async()=>((null==T?void 0:T.render404)?await T.render404(e,t,R,!1):t.end("This page could not be found"),null);if(k&&!_){let e=!!F.routes[N],t=F.dynamicRoutes[P];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await j();throw new x.NoFallbackError}}let q=null;!k||O.isDev||_||(q=N,q="/index"===q?"/":q);let $=!0===O.isDev||!k,U=k&&!$;M&&S&&(0,l.setReferenceManifestsSingleton)({page:n,clientReferenceManifest:S,serverActionsManifest:M,serverModuleMap:(0,c.createServerModuleMap)({serverActionsManifest:M})});let D=e.method||"GET",L=(0,i.getTracer)(),G=L.getActiveScopeSpan(),H={params:b,prerenderManifest:F,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:$,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>O.onRequestError(e,t,n,T)},sharedContext:{buildId:v}},B=new d.NodeNextRequest(e),W=new d.NodeNextResponse(t),V=p.NextRequestAdapter.fromNodeNextRequest(B,(0,p.signalFromNodeResponse)(t));try{let o=async e=>O.handle(V,H).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=L.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==f.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=r.get("next.route");if(s){let t=`${D} ${s}`;e.setAttributes({"next.route":s,"http.route":s,"next.span_name":t}),e.updateName(t)}else e.updateName(`${D} ${n}`)}),l=!!(0,a.getRequestMeta)(e,"minimalMode"),c=async a=>{var i,c;let u=async({previousCacheEntry:s})=>{try{if(!l&&A&&I&&!s)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await o(a);e.fetchMetrics=H.renderOpts.fetchMetrics;let i=H.renderOpts.pendingWaitUntil;i&&r.waitUntil&&(r.waitUntil(i),i=void 0);let c=H.renderOpts.collectedTags;if(!k)return await (0,g.sendResponse)(B,W,n,H.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(n.headers);c&&(t[y.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==H.renderOpts.collectedRevalidate&&!(H.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&H.renderOpts.collectedRevalidate,s=void 0===H.renderOpts.collectedExpire||H.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:H.renderOpts.collectedExpire;return{value:{kind:E.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:s}}}}catch(t){throw(null==s?void 0:s.isStale)&&await O.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:A})},T),t}},d=await O.handleResponse({req:e,nextConfig:w,cacheKey:q,routeKind:s.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:F,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:I,responseGenerator:u,waitUntil:r.waitUntil,isMinimalMode:l});if(!k)return null;if((null==d||null==(i=d.value)?void 0:i.kind)!==E.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(c=d.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",A?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),_&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,m.fromNodeOutgoingHttpHeaders)(d.value.headers);return l&&k||p.delete(y.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,C.getCacheControlHeader)(d.cacheControl)),await (0,g.sendResponse)(B,W,new Response(d.value.body,{headers:p,status:d.value.status||200})),null};G?await c(G):await L.withPropagatedContext(e.headers,()=>L.trace(f.BaseServerSpan.handleRequest,{spanName:`${D} ${n}`,kind:i.SpanKind.SERVER,attributes:{"http.method":D,"http.target":e.url}},c))}catch(t){if(t instanceof x.NoFallbackError||await O.onRequestError(e,t,{routerKind:"App Router",routePath:P,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:A})}),k)throw t;return await (0,g.sendResponse)(B,W,new Response(null,{status:500})),null}}e.s(["handler",()=>R,"patchFetch",()=>w,"routeModule",()=>O,"serverHooks",()=>T,"workAsyncStorage",()=>_,"workUnitAsyncStorage",()=>F]),r()}catch(e){r(e)}},!1),967030,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_@vercel_oidc_dist_7c2bef69._.js"].map(t=>e.l(t))).then(()=>t(783697)))},683671,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_@vercel_oidc_dist_7fd3d757._.js"].map(t=>e.l(t))).then(()=>t(390391)))},421024,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_4027bc0a._.js"].map(t=>e.l(t))).then(()=>t(736850)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ede5f22b._.js.map