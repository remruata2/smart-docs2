{"version":3,"sources":["../../../node_modules/next-auth/core/types.js","../../../node_modules/next-auth/index.js","../../../src/lib/usage-limits.ts","../../../src/lib/usage-tracking.ts","../../../src/services/subscription-service.ts","../../../node_modules/date-fns/constants.js","../../../node_modules/date-fns/constructFrom.js","../../../node_modules/date-fns/toDate.js","../../../node_modules/date-fns/startOfMonth.js","../../../node_modules/date-fns/endOfMonth.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar _exportNames = {};\nObject.defineProperty(exports, \"default\", {\n  enumerable: true,\n  get: function () {\n    return _next.default;\n  }\n});\nvar _types = require(\"./core/types\");\nObject.keys(_types).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;\n  if (key in exports && exports[key] === _types[key]) return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function () {\n      return _types[key];\n    }\n  });\n});\nvar _next = _interopRequireWildcard(require(\"./next\"));\nObject.keys(_next).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;\n  if (key in exports && exports[key] === _next[key]) return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function () {\n      return _next[key];\n    }\n  });\n});\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }","import { getServerSession } from \"next-auth\";\nimport { authOptions } from \"@/lib/auth-options\";\nimport { getCurrentUsage } from \"@/lib/usage-tracking\";\nimport { getUserLimits } from \"@/services/subscription-service\";\nimport { UsageType } from \"@/generated/prisma\";\n\nexport interface UsageLimitResult {\n\tallowed: boolean;\n\treason?: string;\n\tcurrentUsage?: number;\n\tlimit?: number;\n}\n\n/**\n * Check if user can perform an action based on their subscription limits\n */\nexport async function checkUsageLimit(\n\tusageType: UsageType,\n\tuserId?: number\n): Promise<UsageLimitResult> {\n\ttry {\n\t\t// Skip usage limits in development mode or if DISABLE_USAGE_LIMITS is set\n\t\tif (\n\t\t\tprocess.env.NODE_ENV === \"development\" ||\n\t\t\tprocess.env.DISABLE_USAGE_LIMITS === \"true\"\n\t\t) {\n\t\t\tconsole.log(\n\t\t\t\t\"[USAGE-LIMITS] Usage limits disabled (development mode or DISABLE_USAGE_LIMITS=true)\"\n\t\t\t);\n\t\t\treturn {\n\t\t\t\tallowed: true,\n\t\t\t\tcurrentUsage: 0,\n\t\t\t\tlimit: -1, // Unlimited\n\t\t\t};\n\t\t}\n\n\t\t// Get session if userId not provided\n\t\tif (!userId) {\n\t\t\tconst session = await getServerSession(authOptions);\n\t\t\tif (!session?.user?.id) {\n\t\t\t\treturn {\n\t\t\t\t\tallowed: false,\n\t\t\t\t\treason: \"Authentication required\",\n\t\t\t\t};\n\t\t\t}\n\t\t\tuserId = parseInt(session.user.id as string);\n\t\t}\n\n\t\t// Get user's limits\n\t\tconst limits = await getUserLimits(userId);\n\t\tconst limit =\n\t\t\tlimits[\n\t\t\t\tusageType === \"file_upload\"\n\t\t\t\t\t? \"files\"\n\t\t\t\t\t: usageType === \"chat_message\"\n\t\t\t\t\t? \"chats\"\n\t\t\t\t\t: \"exports\"\n\t\t\t];\n\n\t\t// Unlimited plans\n\t\tif (limit === -1) {\n\t\t\treturn {\n\t\t\t\tallowed: true,\n\t\t\t\tcurrentUsage: 0,\n\t\t\t\tlimit: -1,\n\t\t\t};\n\t\t}\n\n\t\t// Check current usage\n\t\tconst currentUsage = await getCurrentUsage(userId, usageType);\n\t\tconst allowed = currentUsage < limit;\n\n\t\treturn {\n\t\t\tallowed,\n\t\t\tcurrentUsage,\n\t\t\tlimit,\n\t\t\treason: allowed\n\t\t\t\t? undefined\n\t\t\t\t: `You have reached your ${usageType.replace(\n\t\t\t\t\t\t\"_\",\n\t\t\t\t\t\t\" \"\n\t\t\t\t  )} limit of ${limit}. Please upgrade your plan.`,\n\t\t};\n\t} catch (error) {\n\t\tconsole.error(\"[USAGE-LIMITS] Error checking usage limit:\", error);\n\t\treturn {\n\t\t\tallowed: false,\n\t\t\treason: \"Error checking usage limits\",\n\t\t};\n\t}\n}\n\n/**\n * Middleware helper to enforce usage limits in API routes\n */\nexport async function enforceUsageLimit(\n\tusageType: UsageType,\n\tuserId?: number\n): Promise<\n\t{ success: true } | { success: false; error: string; status: number }\n> {\n\t// Skip usage limits in development mode or if DISABLE_USAGE_LIMITS is set\n\tif (\n\t\tprocess.env.NODE_ENV === \"development\" ||\n\t\tprocess.env.DISABLE_USAGE_LIMITS === \"true\"\n\t) {\n\t\tconsole.log(\n\t\t\t\"[USAGE-LIMITS] Usage limits disabled (development mode or DISABLE_USAGE_LIMITS=true)\"\n\t\t);\n\t\treturn { success: true };\n\t}\n\n\tconst result = await checkUsageLimit(usageType, userId);\n\n\tif (!result.allowed) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror: result.reason || \"Usage limit exceeded\",\n\t\t\tstatus: 429, // Too Many Requests\n\t\t};\n\t}\n\n\treturn { success: true };\n}\n","import { db } from \"@/lib/db\";\nimport { UsageType, Prisma } from \"@/generated/prisma\";\nimport { startOfMonth, endOfMonth } from \"date-fns\";\n\n/**\n * Track usage for a user\n */\nexport async function trackUsage(\n\tuserId: number,\n\tusageType: UsageType,\n\tcount: number = 1,\n\tmetadata?: Record<string, any>\n) {\n\tconst now = new Date();\n\tconst periodStart = startOfMonth(now);\n\tconst periodEnd = endOfMonth(now);\n\n\t// Check if usage record exists for this period\n\tconst existing = await db.usageTracking.findFirst({\n\t\twhere: {\n\t\t\tuser_id: userId,\n\t\t\tusage_type: usageType,\n\t\t\tperiod_start: periodStart,\n\t\t\tperiod_end: periodEnd,\n\t\t},\n\t});\n\n\tif (existing) {\n\t\t// Update existing record\n\t\treturn await db.usageTracking.update({\n\t\t\twhere: { id: existing.id },\n\t\t\tdata: {\n\t\t\t\tcount: existing.count + count,\n\t\t\t\tmetadata: metadata\n\t\t\t\t\t? { ...(existing.metadata as object), ...metadata }\n\t\t\t\t\t: existing.metadata === null\n\t\t\t\t\t\t? Prisma.JsonNull\n\t\t\t\t\t\t: existing.metadata,\n\t\t\t},\n\t\t});\n\t} else {\n\t\t// Create new record\n\t\treturn await db.usageTracking.create({\n\t\t\tdata: {\n\t\t\t\tuser_id: userId,\n\t\t\t\tusage_type: usageType,\n\t\t\t\tcount,\n\t\t\t\tperiod_start: periodStart,\n\t\t\t\tperiod_end: periodEnd,\n\t\t\t\tmetadata: metadata || {},\n\t\t\t},\n\t\t});\n\t}\n}\n\n/**\n * Get current period usage for a user\n */\nexport async function getCurrentUsage(\n\tuserId: number,\n\tusageType: UsageType\n): Promise<number> {\n\tconst now = new Date();\n\tconst periodStart = startOfMonth(now);\n\tconst periodEnd = endOfMonth(now);\n\n\tconst usage = await db.usageTracking.findFirst({\n\t\twhere: {\n\t\t\tuser_id: userId,\n\t\t\tusage_type: usageType,\n\t\t\tperiod_start: periodStart,\n\t\t\tperiod_end: periodEnd,\n\t\t},\n\t});\n\n\treturn usage?.count || 0;\n}\n\n/**\n * Get all current period usage for a user\n */\nexport async function getAllCurrentUsage(userId: number) {\n\tconst now = new Date();\n\tconst periodStart = startOfMonth(now);\n\tconst periodEnd = endOfMonth(now);\n\n\tconst usageRecords = await db.usageTracking.findMany({\n\t\twhere: {\n\t\t\tuser_id: userId,\n\t\t\tperiod_start: periodStart,\n\t\t\tperiod_end: periodEnd,\n\t\t},\n\t});\n\n\tconst usage: Record<UsageType, number> = {\n\t\tfile_upload: 0,\n\t\tchat_message: 0,\n\t\tdocument_export: 0,\n\t\tai_processing: 0,\n\t\tquiz_generation: 0,\n\t\tbattle_match: 0,\n\t\tai_tutor_session: 0,\n\t};\n\n\tusageRecords.forEach((record) => {\n\t\tusage[record.usage_type] = record.count;\n\t});\n\n\treturn usage;\n}\n\n/**\n * Check if user has exceeded limit for a usage type\n */\nexport async function hasExceededLimit(\n\tuserId: number,\n\tusageType: UsageType,\n\tlimit: number\n): Promise<boolean> {\n\tconst currentUsage = await getCurrentUsage(userId, usageType);\n\treturn currentUsage >= limit;\n}\n\n/**\n * Check if user can perform an action (hasn't exceeded limit)\n */\nexport async function canPerformAction(\n\tuserId: number,\n\tusageType: UsageType,\n\tlimit: number\n): Promise<boolean> {\n\treturn !(await hasExceededLimit(userId, usageType, limit));\n}\n\n/**\n * Get usage statistics for a user\n */\nexport async function getUserUsageStats(userId: number) {\n\tconst now = new Date();\n\tconst periodStart = startOfMonth(now);\n\tconst periodEnd = endOfMonth(now);\n\n\tconst usageRecords = await db.usageTracking.findMany({\n\t\twhere: {\n\t\t\tuser_id: userId,\n\t\t\tperiod_start: {\n\t\t\t\tgte: periodStart,\n\t\t\t\tlte: periodEnd,\n\t\t\t},\n\t\t},\n\t\torderBy: {\n\t\t\tcreated_at: \"desc\",\n\t\t},\n\t});\n\n\treturn usageRecords;\n}\n","import { db } from \"@/lib/db\";\nimport { SubscriptionStatus, BillingCycle } from \"@/generated/prisma\";\n\n/**\n * Get subscription plan by ID\n */\nexport async function getSubscriptionPlan(planId: number) {\n\treturn await db.subscriptionPlan.findUnique({\n\t\twhere: { id: planId },\n\t});\n}\n\n/**\n * Get all active subscription plans\n */\nexport async function getActivePlans() {\n\treturn await db.subscriptionPlan.findMany({\n\t\twhere: { is_active: true },\n\t\torderBy: { price_monthly: \"asc\" },\n\t});\n}\n\n/**\n * Get default subscription plan (free tier)\n */\nexport async function getDefaultPlan() {\n\treturn await db.subscriptionPlan.findFirst({\n\t\twhere: { is_default: true, is_active: true },\n\t});\n}\n\n/**\n * Get user's current subscription\n */\nexport async function getUserSubscription(userId: number) {\n\treturn await db.userSubscription.findUnique({\n\t\twhere: { user_id: userId },\n\t\tinclude: {\n\t\t\tplan: true,\n\t\t},\n\t});\n}\n\n/**\n * Create or update user subscription\n */\nexport async function upsertUserSubscription(\n\tuserId: number,\n\tdata: {\n\t\tplanId: number;\n\t\trazorpaySubscriptionId?: string;\n\t\trazorpayCustomerId?: string;\n\t\trazorpayOrderId?: string;\n\t\tstatus?: SubscriptionStatus;\n\t\tbillingCycle?: BillingCycle;\n\t\tcurrentPeriodStart: Date;\n\t\tcurrentPeriodEnd: Date;\n\t}\n) {\n\tconst {\n\t\tplanId,\n\t\trazorpaySubscriptionId,\n\t\trazorpayCustomerId,\n\t\trazorpayOrderId,\n\t\tstatus = SubscriptionStatus.active,\n\t\tbillingCycle = BillingCycle.monthly,\n\t\tcurrentPeriodStart,\n\t\tcurrentPeriodEnd,\n\t} = data;\n\n\treturn await db.userSubscription.upsert({\n\t\twhere: { user_id: userId },\n\t\tupdate: {\n\t\t\tplan_id: planId,\n\t\t\trazorpay_subscription_id: razorpaySubscriptionId,\n\t\t\trazorpay_customer_id: razorpayCustomerId,\n\t\t\trazorpay_order_id: razorpayOrderId,\n\t\t\tstatus,\n\t\t\tbilling_cycle: billingCycle,\n\t\t\tcurrent_period_start: currentPeriodStart,\n\t\t\tcurrent_period_end: currentPeriodEnd,\n\t\t},\n\t\tcreate: {\n\t\t\tuser_id: userId,\n\t\t\tplan_id: planId,\n\t\t\trazorpay_subscription_id: razorpaySubscriptionId,\n\t\t\trazorpay_customer_id: razorpayCustomerId,\n\t\t\trazorpay_order_id: razorpayOrderId,\n\t\t\tstatus,\n\t\t\tbilling_cycle: billingCycle,\n\t\t\tcurrent_period_start: currentPeriodStart,\n\t\t\tcurrent_period_end: currentPeriodEnd,\n\t\t},\n\t\tinclude: {\n\t\t\tplan: true,\n\t\t},\n\t});\n}\n\n/**\n * Cancel user subscription\n */\nexport async function cancelSubscription(\n\tuserId: number,\n\tcancelAtPeriodEnd: boolean = true\n) {\n\treturn await db.userSubscription.update({\n\t\twhere: { user_id: userId },\n\t\tdata: {\n\t\t\tcancel_at_period_end: cancelAtPeriodEnd,\n\t\t\tcanceled_at: cancelAtPeriodEnd ? null : new Date(),\n\t\t\tstatus: cancelAtPeriodEnd\n\t\t\t\t? SubscriptionStatus.active\n\t\t\t\t: SubscriptionStatus.canceled,\n\t\t},\n\t\tinclude: {\n\t\t\tplan: true,\n\t\t},\n\t});\n}\n\n/**\n * Update subscription status\n */\nexport async function updateSubscriptionStatus(\n\tuserId: number,\n\tstatus: SubscriptionStatus\n) {\n\treturn await db.userSubscription.update({\n\t\twhere: { user_id: userId },\n\t\tdata: { status },\n\t\tinclude: {\n\t\t\tplan: true,\n\t\t},\n\t});\n}\n\n/**\n * Get user's subscription limits\n */\nexport async function getUserLimits(userId: number) {\n\tconst subscription = await getUserSubscription(userId);\n\n\tif (!subscription) {\n\t\t// Return default plan limits if no subscription\n\t\tconst defaultPlan = await getDefaultPlan();\n\t\tif (!defaultPlan) {\n\t\t\t// Fallback to free tier limits if no default plan exists in database\n\t\t\t// This handles cases where the database hasn't been seeded yet\n\t\t\tconsole.warn(\n\t\t\t\t\"[SUBSCRIPTION-SERVICE] No default plan found, using fallback free tier limits\"\n\t\t\t);\n\t\t\treturn {\n\t\t\t\tfiles: 10,\n\t\t\t\tchats: 20,\n\t\t\t\texports: 5,\n\t\t\t};\n\t\t}\n\t\treturn defaultPlan.limits as {\n\t\t\tfiles: number;\n\t\t\tchats: number;\n\t\t\texports: number;\n\t\t};\n\t}\n\n\treturn subscription.plan.limits as {\n\t\tfiles: number;\n\t\tchats: number;\n\t\texports: number;\n\t};\n}\n\n/**\n * Check if user has active subscription\n */\nexport async function hasActiveSubscription(userId: number): Promise<boolean> {\n\tconst subscription = await getUserSubscription(userId);\n\n\tif (!subscription) {\n\t\treturn false;\n\t}\n\n\treturn (\n\t\tsubscription.status === SubscriptionStatus.active ||\n\t\tsubscription.status === SubscriptionStatus.trialing\n\t);\n}\n\n/**\n * Get subscription features\n */\nexport async function getUserFeatures(userId: number) {\n\tconst subscription = await getUserSubscription(userId);\n\n\tif (!subscription) {\n\t\tconst defaultPlan = await getDefaultPlan();\n\t\tif (!defaultPlan) {\n\t\t\treturn [];\n\t\t}\n\t\treturn (defaultPlan.features as string[]) || [];\n\t}\n\n\treturn (subscription.plan.features as string[]) || [];\n}\n","/**\n * @module constants\n * @summary Useful constants\n * @description\n * Collection of useful date constants.\n *\n * The constants could be imported from `date-fns/constants`:\n *\n * ```ts\n * import { maxTime, minTime } from \"./constants/date-fns/constants\";\n *\n * function isAllowedTime(time) {\n *   return time <= maxTime && time >= minTime;\n * }\n * ```\n */\n\n/**\n * @constant\n * @name daysInWeek\n * @summary Days in 1 week.\n */\nexport const daysInWeek = 7;\n\n/**\n * @constant\n * @name daysInYear\n * @summary Days in 1 year.\n *\n * @description\n * How many days in a year.\n *\n * One years equals 365.2425 days according to the formula:\n *\n * > Leap year occurs every 4 years, except for years that are divisible by 100 and not divisible by 400.\n * > 1 mean year = (365+1/4-1/100+1/400) days = 365.2425 days\n */\nexport const daysInYear = 365.2425;\n\n/**\n * @constant\n * @name maxTime\n * @summary Maximum allowed time.\n *\n * @example\n * import { maxTime } from \"./constants/date-fns/constants\";\n *\n * const isValid = 8640000000000001 <= maxTime;\n * //=> false\n *\n * new Date(8640000000000001);\n * //=> Invalid Date\n */\nexport const maxTime = Math.pow(10, 8) * 24 * 60 * 60 * 1000;\n\n/**\n * @constant\n * @name minTime\n * @summary Minimum allowed time.\n *\n * @example\n * import { minTime } from \"./constants/date-fns/constants\";\n *\n * const isValid = -8640000000000001 >= minTime;\n * //=> false\n *\n * new Date(-8640000000000001)\n * //=> Invalid Date\n */\nexport const minTime = -maxTime;\n\n/**\n * @constant\n * @name millisecondsInWeek\n * @summary Milliseconds in 1 week.\n */\nexport const millisecondsInWeek = 604800000;\n\n/**\n * @constant\n * @name millisecondsInDay\n * @summary Milliseconds in 1 day.\n */\nexport const millisecondsInDay = 86400000;\n\n/**\n * @constant\n * @name millisecondsInMinute\n * @summary Milliseconds in 1 minute\n */\nexport const millisecondsInMinute = 60000;\n\n/**\n * @constant\n * @name millisecondsInHour\n * @summary Milliseconds in 1 hour\n */\nexport const millisecondsInHour = 3600000;\n\n/**\n * @constant\n * @name millisecondsInSecond\n * @summary Milliseconds in 1 second\n */\nexport const millisecondsInSecond = 1000;\n\n/**\n * @constant\n * @name minutesInYear\n * @summary Minutes in 1 year.\n */\nexport const minutesInYear = 525600;\n\n/**\n * @constant\n * @name minutesInMonth\n * @summary Minutes in 1 month.\n */\nexport const minutesInMonth = 43200;\n\n/**\n * @constant\n * @name minutesInDay\n * @summary Minutes in 1 day.\n */\nexport const minutesInDay = 1440;\n\n/**\n * @constant\n * @name minutesInHour\n * @summary Minutes in 1 hour.\n */\nexport const minutesInHour = 60;\n\n/**\n * @constant\n * @name monthsInQuarter\n * @summary Months in 1 quarter.\n */\nexport const monthsInQuarter = 3;\n\n/**\n * @constant\n * @name monthsInYear\n * @summary Months in 1 year.\n */\nexport const monthsInYear = 12;\n\n/**\n * @constant\n * @name quartersInYear\n * @summary Quarters in 1 year\n */\nexport const quartersInYear = 4;\n\n/**\n * @constant\n * @name secondsInHour\n * @summary Seconds in 1 hour.\n */\nexport const secondsInHour = 3600;\n\n/**\n * @constant\n * @name secondsInMinute\n * @summary Seconds in 1 minute.\n */\nexport const secondsInMinute = 60;\n\n/**\n * @constant\n * @name secondsInDay\n * @summary Seconds in 1 day.\n */\nexport const secondsInDay = secondsInHour * 24;\n\n/**\n * @constant\n * @name secondsInWeek\n * @summary Seconds in 1 week.\n */\nexport const secondsInWeek = secondsInDay * 7;\n\n/**\n * @constant\n * @name secondsInYear\n * @summary Seconds in 1 year.\n */\nexport const secondsInYear = secondsInDay * daysInYear;\n\n/**\n * @constant\n * @name secondsInMonth\n * @summary Seconds in 1 month\n */\nexport const secondsInMonth = secondsInYear / 12;\n\n/**\n * @constant\n * @name secondsInQuarter\n * @summary Seconds in 1 quarter.\n */\nexport const secondsInQuarter = secondsInMonth * 3;\n\n/**\n * @constant\n * @name constructFromSymbol\n * @summary Symbol enabling Date extensions to inherit properties from the reference date.\n *\n * The symbol is used to enable the `constructFrom` function to construct a date\n * using a reference date and a value. It allows to transfer extra properties\n * from the reference date to the new date. It's useful for extensions like\n * [`TZDate`](https://github.com/date-fns/tz) that accept a time zone as\n * a constructor argument.\n */\nexport const constructFromSymbol = Symbol.for(\"constructDateFrom\");\n","import { constructFromSymbol } from \"./constants.js\";\n\n/**\n * @name constructFrom\n * @category Generic Helpers\n * @summary Constructs a date using the reference date and the value\n *\n * @description\n * The function constructs a new date using the constructor from the reference\n * date and the given value. It helps to build generic functions that accept\n * date extensions.\n *\n * It defaults to `Date` if the passed reference date is a number or a string.\n *\n * Starting from v3.7.0, it allows to construct a date using `[Symbol.for(\"constructDateFrom\")]`\n * enabling to transfer extra properties from the reference date to the new date.\n * It's useful for extensions like [`TZDate`](https://github.com/date-fns/tz)\n * that accept a time zone as a constructor argument.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n *\n * @param date - The reference date to take constructor from\n * @param value - The value to create the date\n *\n * @returns Date initialized using the given date and value\n *\n * @example\n * import { constructFrom } from \"./constructFrom/date-fns\";\n *\n * // A function that clones a date preserving the original type\n * function cloneDate<DateType extends Date>(date: DateType): DateType {\n *   return constructFrom(\n *     date, // Use constructor from the given date\n *     date.getTime() // Use the date value to create a new date\n *   );\n * }\n */\nexport function constructFrom(date, value) {\n  if (typeof date === \"function\") return date(value);\n\n  if (date && typeof date === \"object\" && constructFromSymbol in date)\n    return date[constructFromSymbol](value);\n\n  if (date instanceof Date) return new date.constructor(value);\n\n  return new Date(value);\n}\n\n// Fallback for modularized imports:\nexport default constructFrom;\n","import { constructFrom } from \"./constructFrom.js\";\n\n/**\n * @name toDate\n * @category Common Helpers\n * @summary Convert the given argument to an instance of Date.\n *\n * @description\n * Convert the given argument to an instance of Date.\n *\n * If the argument is an instance of Date, the function returns its clone.\n *\n * If the argument is a number, it is treated as a timestamp.\n *\n * If the argument is none of the above, the function returns Invalid Date.\n *\n * Starting from v3.7.0, it clones a date using `[Symbol.for(\"constructDateFrom\")]`\n * enabling to transfer extra properties from the reference date to the new date.\n * It's useful for extensions like [`TZDate`](https://github.com/date-fns/tz)\n * that accept a time zone as a constructor argument.\n *\n * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param argument - The value to convert\n *\n * @returns The parsed date in the local time zone\n *\n * @example\n * // Clone the date:\n * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert the timestamp to date:\n * const result = toDate(1392098430000)\n * //=> Tue Feb 11 2014 11:30:30\n */\nexport function toDate(argument, context) {\n  // [TODO] Get rid of `toDate` or `constructFrom`?\n  return constructFrom(context || argument, argument);\n}\n\n// Fallback for modularized imports:\nexport default toDate;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link startOfMonth} function options.\n */\n\n/**\n * @name startOfMonth\n * @category Month Helpers\n * @summary Return the start of a month for the given date.\n *\n * @description\n * Return the start of a month for the given date. The result will be in the local timezone.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments.\n * Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed,\n * or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - An object with options\n *\n * @returns The start of a month\n *\n * @example\n * // The start of a month for 2 September 2014 11:55:00:\n * const result = startOfMonth(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Mon Sep 01 2014 00:00:00\n */\nexport function startOfMonth(date, options) {\n  const _date = toDate(date, options?.in);\n  _date.setDate(1);\n  _date.setHours(0, 0, 0, 0);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default startOfMonth;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link endOfMonth} function options.\n */\n\n/**\n * @name endOfMonth\n * @category Month Helpers\n * @summary Return the end of a month for the given date.\n *\n * @description\n * Return the end of a month for the given date.\n * The result will be in the local timezone.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - An object with options\n *\n * @returns The end of a month\n *\n * @example\n * // The end of a month for 2 September 2014 11:55:00:\n * const result = endOfMonth(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 30 2014 23:59:59.999\n */\nexport function endOfMonth(date, options) {\n  const _date = toDate(date, options?.in);\n  const month = _date.getMonth();\n  _date.setFullYear(_date.getFullYear(), month + 1, 0);\n  _date.setHours(23, 59, 59, 999);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default endOfMonth;\n"],"names":[],"mappings":"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","ignoreList":[0,1,5,6,7,8,9]}